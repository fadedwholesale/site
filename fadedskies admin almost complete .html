<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Faded Skies - Admin Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background: #000;
            overflow-x: hidden;
        }

        /* Universal selector for all text elements to ensure visibility on dark background */
        html, body, h1, h2, h3, h4, h5, h6, p, span, label, input, select, textarea, th, td, small, strong, div {
            color: var(--text-primary);
        }

        :root {
            --brand-green: #00C851;
            --brand-green-light: #1DD65F;
            --brand-green-dark: #00A544;
            --accent-lime: #39FF14;
            --accent-red: #FF4444;
            --accent-orange: #FFA500;
            --accent-blue: #00BFFF;
            --surface-dark: #0a0a0a;
            --surface-card: #111111;
            --surface-elevated: #1a1a1a;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --text-muted: #666666;
            --border-subtle: #222222;
            --shadow-glow: 0 0 40px rgba(0, 200, 81, 0.3);
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 0 24px;
        }

        /* Animated Background */
        .bg-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(0, 200, 81, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 200, 81, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: grid-move 20s linear infinite;
            pointer-events: none;
            z-index: 1;
        }

        @keyframes grid-move {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }

        /* Header */
        header {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-subtle);
            z-index: 1000;
            padding: 20px 0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-family: 'Comic Sans MS', cursive;
            font-weight: 900;
            font-size: 1.8rem;
            color: white;
            text-shadow: 0 0 20px var(--brand-green);
            cursor: pointer;
        }

        .admin-indicator {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            background: linear-gradient(135deg, var(--accent-blue), #1E90FF);
            border-radius: 25px;
            color: white;
            font-weight: 700;
            font-size: 14px;
            box-shadow: 0 4px 15px rgba(0, 191, 255, 0.3);
        }

        .sync-status {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 16px;
            background: var(--surface-card);
            border-radius: 25px;
            border: 1px solid var(--brand-green);
            font-size: 12px;
            color: var(--brand-green);
            box-shadow: 0 2px 10px rgba(0, 200, 81, 0.2);
        }

        .nav-info {
            display: flex;
            align-items: center;
            gap: 20px;
            color: var(--text-secondary);
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            text-decoration: none;
            transition: all 0.4s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-family: inherit;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .btn:hover::before {
            opacity: 1;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--brand-green), var(--brand-green-light));
            color: white;
            box-shadow: var(--shadow-glow);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 32px rgba(0, 200, 81, 0.4), var(--shadow-glow);
        }

        .btn-secondary {
            background: transparent;
            color: var(--brand-green);
            border: 2px solid var(--brand-green);
            box-shadow: 0 4px 16px rgba(0, 200, 81, 0.1);
        }

        .btn-secondary:hover {
            background: var(--brand-green);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(0, 200, 81, 0.3);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--accent-red), #FF6666);
            color: white;
            box-shadow: 0 4px 16px rgba(255, 68, 68, 0.3);
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(255, 68, 68, 0.4);
        }

        .btn-admin {
            background: linear-gradient(135deg, var(--accent-blue), #1E90FF);
            color: white;
            box-shadow: 0 4px 16px rgba(0, 191, 255, 0.3);
        }

        .btn-admin:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(0, 191, 255, 0.4);
        }

        .btn-sm {
            padding: 10px 20px;
            font-size: 12px;
            border-radius: 8px;
        }

        /* Main Content */
        main {
            margin-top: 100px;
            position: relative;
            z-index: 2;
            padding: 50px 0;
        }

        /* Login Screen */
        .login-screen {
            min-height: calc(100vh - 100px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px 0;
            width: 100vw;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 2001;
            background: transparent;
        }
        .login-screen .container {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
        }

        .login-card {
            background: var(--surface-card);
            padding: 50px;
            border-radius: 24px;
            border: 1px solid var(--border-subtle);
            max-width: 550px;
            width: 100%;
            text-align: center;
            box-shadow: 0 32px 80px rgba(0, 200, 81, 0.15);
        }

        .login-title {
            color: var(--brand-green);
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 40px;
        }

        /* Dashboard */
        .dashboard {
            display: none;
        }

        .dashboard.active {
            display: block;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: 50px;
            padding: 60px 0;
            background: linear-gradient(135deg, var(--surface-dark) 0%, #001a0a 50%, var(--surface-dark) 100%);
            border-radius: 24px;
            border: 1px solid var(--border-subtle);
            box-shadow: 0 16px 40px rgba(0, 200, 81, 0.1);
        }

        .dashboard-title {
            font-size: 3.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--brand-green) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .stat-card {
            background: var(--surface-card);
            padding: 32px;
            border-radius: 20px;
            border: 1px solid var(--border-subtle);
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0, 200, 81, 0.05), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-6px);
            border-color: var(--brand-green);
            box-shadow: 0 16px 48px rgba(0, 200, 81, 0.25);
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-number {
            font-size: 3rem;
            font-weight: 900;
            color: var(--brand-green);
            margin-bottom: 12px;
            text-shadow: 0 0 20px var(--brand-green);
        }

        .stat-label {
            color: var(--text-secondary);
            font-weight: 500;
            font-size: 1.1rem;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 6px;
            margin-bottom: 50px;
            background: var(--surface-card);
            padding: 8px;
            border-radius: 16px;
            border: 1px solid var(--border-subtle);
            overflow-x: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        .tab {
            flex: 1;
            min-width: 160px;
            padding: 18px 24px;
            background: transparent;
            color: var(--text-secondary);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0, 200, 81, 0.1), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .tab.active {
            background: linear-gradient(135deg, var(--brand-green), var(--brand-green-light));
            color: white;
            box-shadow: var(--shadow-glow);
            transform: translateY(-2px);
        }

        .tab:hover:not(.active) {
            background: rgba(0, 200, 81, 0.1);
            color: var(--text-primary);
        }

        .tab:hover:not(.active)::before {
            opacity: 1;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Controls */
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            padding: 28px;
            background: var(--surface-card);
            border-radius: 16px;
            border: 1px solid var(--border-subtle);
            flex-wrap: wrap;
            gap: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
        }

        .search-group {
            display: flex;
            gap: 16px;
            align-items: center;
            flex-wrap: wrap;
        }

        .search-input {
            padding: 14px 18px;
            border: 2px solid var(--border-subtle);
            border-radius: 12px;
            background: var(--surface-dark);
            color: var(--text-primary);
            font-size: 14px;
            width: 320px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--brand-green);
            box-shadow: 0 0 0 4px rgba(0, 200, 81, 0.15), 0 4px 20px rgba(0, 0, 0, 0.2);
            transform: translateY(-1px);
        }

        .action-group {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .filter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 10px 18px;
            background: var(--surface-elevated);
            color: var(--text-secondary);
            border: 1px solid var(--border-subtle);
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .filter-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--brand-green), var(--brand-green-light));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .filter-btn.active,
        .filter-btn:hover {
            background: var(--brand-green);
            color: white;
            border-color: var(--brand-green);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 200, 81, 0.3);
        }

        .filter-btn.active::before,
        .filter-btn:hover::before {
            opacity: 1;
        }

        /* Data Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--surface-card);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.25);
            margin-bottom: 50px;
        }

        .data-table th {
            background: linear-gradient(135deg, var(--brand-green), var(--brand-green-light));
            color: white;
            padding: 24px 20px;
            text-align: left;
            font-weight: 700;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            position: relative;
        }

        .data-table th::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, var(--brand-green-light), var(--brand-green));
        }

        .data-table td {
            padding: 24px 20px;
            border-bottom: 1px solid var(--border-subtle);
            color: var(--text-primary);
            font-size: 14px;
            line-height: 1.5;
            transition: background-color 0.3s ease;
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        .data-table tr:hover {
            background: rgba(0, 200, 81, 0.08);
        }

        .data-table tr:hover td {
            transform: translateX(2px);
            transition: transform 0.3s ease;
        }

        .editable {
            background: transparent;
            border: 1px solid var(--border-subtle);
            color: var(--text-primary);
            padding: 10px 12px;
            border-radius: 8px;
            transition: all 0.3s ease;
            width: 100%;
            font-size: 14px;
        }

        .editable:focus {
            outline: none;
            border-color: var(--brand-green);
            background: var(--surface-dark);
            box-shadow: 0 0 0 3px rgba(0, 200, 81, 0.2);
            transform: translateY(-1px);
        }

        /* Status Styles */
        .status-available { color: var(--brand-green); font-weight: 700; }
        .status-coming, .status-comingsoon { color: var(--accent-orange); font-weight: 700; }
        .status-soldout { color: var(--accent-red); font-weight: 700; }
        .status-pending { color: var(--accent-orange); font-weight: 700; }
        .status-processing { color: var(--accent-blue); font-weight: 700; }
        .status-shipped { color: var(--brand-green); font-weight: 700; }
        .status-delivered { color: var(--brand-green); font-weight: 700; opacity: 0.8; }
        .status-cancelled { color: var(--accent-red); font-weight: 700; }

        /* Modal System */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 2000;
            backdrop-filter: blur(12px);
            animation: modalFadeIn 0.3s ease-out;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--surface-card);
            padding: 50px;
            border-radius: 24px;
            border: 1px solid var(--border-subtle);
            max-width: 700px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 32px 80px rgba(0, 0, 0, 0.4);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from { 
                opacity: 0;
                transform: translate(-50%, -60%);
            }
            to { 
                opacity: 1;
                transform: translate(-50%, -50%);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .modal-title {
            color: var(--brand-green);
            font-size: 1.8rem;
            font-weight: 700;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 1.8rem;
            cursor: pointer;
            padding: 12px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: var(--surface-elevated);
            color: var(--accent-red);
            transform: rotate(90deg);
        }

        .form-group {
            margin-bottom: 28px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 15px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 16px 18px;
            border: 2px solid var(--border-subtle);
            border-radius: 12px;
            font-size: 15px;
            background: var(--surface-dark);
            color: var(--text-primary);
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--brand-green);
            box-shadow: 0 0 0 4px rgba(0, 200, 81, 0.15);
            transform: translateY(-1px);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        /* Charts and Analytics */
        .chart-container {
            background: var(--surface-card);
            padding: 24px;
            border-radius: 16px;
            border: 1px solid var(--border-subtle);
            margin-bottom: 24px;
        }

        .chart-title {
            color: var(--brand-green);
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .progress-bar {
            background: var(--surface-dark);
            border-radius: 10px;
            overflow: hidden;
            margin: 8px 0;
        }

        .progress-fill {
            height: 20px;
            background: linear-gradient(135deg, var(--brand-green), var(--brand-green-light));
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        /* Notification System */
        .notification {
            position: fixed;
            top: 120px;
            right: 30px;
            background: var(--surface-card);
            color: var(--text-primary);
            padding: 20px 28px;
            border-radius: 16px;
            border: 1px solid var(--border-subtle);
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.25);
            z-index: 3000;
            transform: translateX(450px);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            max-width: 420px;
            font-weight: 500;
            backdrop-filter: blur(12px);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-color: var(--brand-green);
            box-shadow: 0 16px 48px rgba(0, 200, 81, 0.3);
            background: linear-gradient(135deg, var(--surface-card), rgba(0, 200, 81, 0.05));
        }

        .notification.success::before {
            content: '✅';
            margin-right: 12px;
            font-size: 18px;
        }

        .notification.error {
            border-color: var(--accent-red);
            box-shadow: 0 16px 48px rgba(255, 68, 68, 0.3);
            background: linear-gradient(135deg, var(--surface-card), rgba(255, 68, 68, 0.05));
        }

        .notification.error::before {
            content: '❌';
            margin-right: 12px;
            font-size: 18px;
        }

        .notification.warning {
            border-color: var(--accent-orange);
            box-shadow: 0 16px 48px rgba(255, 165, 0, 0.3);
            background: linear-gradient(135deg, var(--surface-card), rgba(255, 165, 0, 0.05));
        }

        .notification.warning::before {
            content: '⚠️';
            margin-right: 12px;
            font-size: 18px;
        }

        /* Grid Layouts */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin-bottom: 30px;
        }

        .card {
            background: var(--surface-card);
            padding: 24px;
            border-radius: 16px;
            border: 1px solid var(--border-subtle);
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: var(--brand-green);
            box-shadow: 0 8px 32px rgba(0, 200, 81, 0.1);
        }

        .card h3 {
            color: var(--brand-green);
            margin-bottom: 16px;
            font-size: 1.2rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 0 20px;
            }

            header {
                padding: 16px 0;
            }

            main {
                margin-top: 90px;
                padding: 30px 0;
            }

            .logo {
                font-size: 1.4rem;
            }

            .dashboard-title {
                font-size: 2.5rem;
            }

            .dashboard-header {
                padding: 40px 20px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .stat-card {
                padding: 24px;
            }

            .stat-number {
                font-size: 2.5rem;
            }

            .tabs {
                flex-direction: column;
                padding: 12px;
            }

            .tab {
                min-width: auto;
                padding: 16px 20px;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
                padding: 24px 20px;
                gap: 16px;
            }

            .search-input {
                width: 100%;
            }

            .action-group {
                justify-content: center;
            }

            .btn {
                padding: 12px 20px;
            }

            .data-table {
                font-size: 12px;
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }

            .data-table th,
            .data-table td {
                padding: 16px 12px;
            }

            .form-row {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .modal-content {
                width: 95%;
                padding: 30px 20px;
                margin: 20px;
                max-height: 90vh;
            }

            .modal-title {
                font-size: 1.5rem;
            }

            .nav-info {
                flex-direction: column;
                gap: 12px;
            }

            .admin-indicator,
            .sync-status {
                padding: 8px 12px;
                font-size: 12px;
            }

            .grid {
                grid-template-columns: 1fr;
                gap: 24px;
            }

            .card {
                padding: 24px 20px;
            }

            .chart-container {
                padding: 24px 20px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 16px;
            }

            .dashboard-title {
                font-size: 2rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .stat-card {
                padding: 20px;
            }

            .stat-number {
                font-size: 2rem;
            }

            .modal-content {
                padding: 24px 16px;
            }

            .btn {
                padding: 10px 16px;
                font-size: 13px;
            }

            .form-group input,
            .form-group select,
            .form-group textarea {
                padding: 14px 16px;
                font-size: 14px;
            }
        }

        /* Real-time Update Animation */
        .updating {
            opacity: 0.6;
            pointer-events: none;
            transform: scale(0.98);
            transition: all 0.3s ease;
        }

        .updated {
            animation: highlight 1.2s ease-out;
        }

        @keyframes highlight {
            0% { 
                background-color: rgba(0, 200, 81, 0.3);
                transform: scale(1.02);
            }
            50% {
                background-color: rgba(0, 200, 81, 0.15);
            }
            100% { 
                background-color: transparent;
                transform: scale(1);
            }
        }

        /* Loading States */
        .loading {
            position: relative;
            overflow: hidden;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 200, 81, 0.2), transparent);
            animation: loading-shimmer 1.5s infinite;
        }

        @keyframes loading-shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* Smooth Transitions */
        * {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        /* Focus States */
        .btn:focus,
        .editable:focus,
        .search-input:focus {
            outline: 2px solid var(--brand-green);
            outline-offset: 2px;
        }

        /* Hover Effects for Interactive Elements */
        .stat-card,
        .card,
        .chart-container,
        .filter-btn,
        .btn {
            cursor: pointer;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--surface-dark);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--brand-green);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--brand-green-light);
        }

        /* Selection Styles */
        ::selection {
            background: rgba(0, 200, 81, 0.3);
            color: var(--text-primary);
        }

        /* Floating Action Effects */
        .floating-action {
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-4px); }
        }

        /* Pulse Animation for Important Elements */
        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(0, 200, 81, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(0, 200, 81, 0); }
            100% { box-shadow: 0 0 0 0 rgba(0, 200, 81, 0); }
        }

        /* Application Review Styles */
        .application-section {
            background: var(--surface-elevated);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--border-subtle);
            margin-bottom: 20px;
        }

        .application-section h4 {
            color: var(--brand-green);
            margin-bottom: 16px;
            font-size: 1.1rem;
            font-weight: 700;
        }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .info-item label {
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .info-item span {
            color: var(--text-primary);
            font-weight: 500;
        }

        .review-documents {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .doc-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-primary);
            font-weight: 500;
            padding: 8px;
            background: var(--surface-dark);
            border-radius: 6px;
        }

        /* Application status styles */
        .status-approved {
            color: var(--brand-green);
            font-weight: 700;
        }

        .status-rejected {
            color: var(--accent-red);
            font-weight: 700;
        }

        .application-row:hover {
            background: rgba(0, 200, 81, 0.05) !important;
            transform: translateX(2px);
            transition: all 0.3s ease;
        }

        @media (max-width: 768px) {
            .info-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="bg-grid"></div>

    <header>
        <nav class="container">
            <div class="logo">
                <img id="adminHeaderLogo" src="" alt="Faded Skies Admin Logo" style="height: 48px; width: auto; margin-right: 10px;" />
                🔧 Faded Skies Admin
            </div>
            <div class="nav-info">
                <div class="admin-indicator">
                    <span>👑</span>
                    <span>Admin Dashboard</span>
                </div>
                <div id="syncStatus" class="sync-status">
                    <span>🔄</span>
                    <span>Syncing with Portal</span>
                </div>
                <div id="adminSession" style="display: none;">
                    <span id="adminWelcome">Welcome, Admin</span>
                    <button class="btn btn-danger btn-sm" onclick="logout()">
                        Logout <span style="padding: 2px 6px; background: rgba(255,68,68,0.2); border-radius: 6px; font-size: 10px;">ADMIN</span>
                    </button>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <!-- Login Screen -->
        <div id="loginScreen" class="login-screen">
            <div class="container">
                <div class="login-card">
                    <h1 class="login-title">🔧 Admin Access Required</h1>
                    <p style="color: var(--text-secondary); margin-bottom: 32px;">
                        Secure admin portal for inventory and operations management<br>
                        This portal is separate from the public website for security
                    </p>
                    <form onsubmit="adminLogin(event)">
                        <div class="form-group">
                            <label for="adminEmail">Admin Email</label>
                            <input type="email" id="adminEmail" required placeholder="admin@fadedskies.com">
                        </div>
                        <div class="form-group">
                            <label for="adminPassword">Admin Password</label>
                            <input type="password" id="adminPassword" required placeholder="Your secure admin password">
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;">Access Admin Dashboard 🚀</button>
                    </form>
                    
                    <div style="margin-top: 32px; padding: 20px; background: var(--surface-elevated); border-radius: 12px; text-align: left;">
                        <h4 style="color: var(--brand-green); margin-bottom: 12px;">🔐 Demo Credentials:</h4>
                        <p style="color: var(--text-muted); font-size: 14px; line-height: 1.8;">
                            <strong>Admin:</strong> admin@fadedskies.com / admin123<br>
                            <small>This is a separate secure admin portal independent from the public website</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Dashboard -->
        <div id="adminDashboard" class="dashboard">
            <div class="container">
                <div class="dashboard-header">
                    <h1 class="dashboard-title">Admin Control Center 🛠️</h1>
                    <p style="color: var(--text-secondary); font-size: 18px;">Complete wholesale operations management with real-time sync to partner portal</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalProducts">0</div>
                        <div class="stat-label">Total Products</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="availableProducts">0</div>
                        <div class="stat-label">Available Products</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalValue">$0</div>
                        <div class="stat-label">Inventory Value</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalOrders">0</div>
                        <div class="stat-label">Total Orders</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="pendingOrders">0</div>
                        <div class="stat-label">Pending Orders</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalRevenue">$0</div>
                        <div class="stat-label">Total Revenue</div>
                    </div>
                </div>

                <div class="tabs">
                    <button class="tab active" onclick="switchTab('inventory')">📦 Inventory Management</button>
                    <button class="tab" onclick="switchTab('orders')">📋 Order Management</button>
                    <button class="tab" onclick="switchTab('pricing')">💰 Pricing Control</button>
                    <button class="tab" onclick="switchTab('partners')">👥 Partner Management</button>
                    <button class="tab" onclick="switchTab('applications')">📋 Business Applications</button>
                    <button class="tab" onclick="switchTab('analytics')">📊 Analytics & Reports</button>
                    <button class="tab" onclick="switchTab('settings')">⚙️ System Settings</button>
                </div>

                <!-- Inventory Management Tab -->
                <div id="inventory" class="tab-content active">
                    <div class="controls">
                        <div class="search-group">
                            <input type="text" class="search-input" placeholder="Search products..." onkeyup="filterProducts(this.value)">
                            <div class="filter-buttons">
                                <button class="filter-btn active" onclick="filterByStatus('all')">All</button>
                                <button class="filter-btn" onclick="filterByStatus('available')">Available</button>
                                <button class="filter-btn" onclick="filterByStatus('coming')">Coming Soon</button>
                                <button class="filter-btn" onclick="filterByStatus('soldout')">Sold Out</button>
                            </div>
                        </div>
                        <div class="action-group">
                            <button class="btn btn-primary" onclick="openModal('addProductModal')">➕ Add Product</button>
                            <button class="btn btn-secondary" onclick="openModal('bulkImportModal')">📥 Bulk Import</button>
                            <button class="btn btn-secondary" onclick="exportInventory()">�� Export CSV</button>
                            <button class="btn btn-secondary" onclick="syncToPortal()">🔄 Sync to Portal</button>
                        </div>
                    </div>

                    <table class="data-table" id="inventoryTable">
                        <thead>
                            <tr>
                                <th>Photo</th>
                                <th>Product ID</th>
                                <th>Grade/Type</th>
                                <th>Strain Details</th>
                                <th>Price ($)</th>
                                <th>THCA %</th>
                                <th>Status</th>
                                <th>Stock</th>
                                <th>Last Modified</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="inventoryBody">
                            <!-- Products will be loaded here -->
                        </tbody>
                    </table>
                </div>

                <!-- Order Management Tab -->
                <div id="orders" class="tab-content">
                    <div class="controls">
                        <div class="search-group">
                            <input type="text" class="search-input" placeholder="Search orders..." onkeyup="filterOrders(this.value)">
                            <div class="filter-buttons">
                                <button class="filter-btn active" onclick="filterOrdersByStatus('all')">All</button>
                                <button class="filter-btn" onclick="filterOrdersByStatus('pending')">Pending</button>
                                <button class="filter-btn" onclick="filterOrdersByStatus('processing')">Processing</button>
                                <button class="filter-btn" onclick="filterOrdersByStatus('shipped')">Shipped</button>
                                <button class="filter-btn" onclick="filterOrdersByStatus('delivered')">Delivered</button>
                            </div>
                        </div>
                        <div class="action-group">
                            <button class="btn btn-primary" onclick="openModal('createOrderModal')">➕ Create Order</button>
                            <button class="btn btn-secondary" onclick="bulkStatusUpdate()">🔄 Bulk Status Update</button>
                            <button class="btn btn-secondary" onclick="exportOrders()">📄 Export Orders</button>
                            <button class="btn btn-secondary" onclick="openModal('customerTrackingModal')">🔍 Customer Tracking</button>
                            <button class="btn btn-admin" onclick="generateBulkShippingLabels()">📦 Bulk Labels</button>
                        </div>
                    </div>

                    <div class="stats-grid" style="margin-bottom: 30px;">
                        <div class="stat-card">
                            <div class="stat-number" id="ordersPending">0</div>
                            <div class="stat-label">Pending Orders</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="ordersProcessing">0</div>
                            <div class="stat-label">Processing</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="ordersShipped">0</div>
                            <div class="stat-label">Shipped Today</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="ordersWithTracking">0</div>
                            <div class="stat-label">Orders with Tracking</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="avgOrderValue">$0</div>
                            <div class="stat-label">Average Order Value</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="deliveredToday">0</div>
                            <div class="stat-label">Delivered Today</div>
                        </div>
                    </div>

                    <table class="data-table" id="ordersTable">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Partner</th>
                                <th>Items</th>
                                <th>Total</th>
                                <th>Status</th>
                                <th>Tracking</th>
                                <th>Payment</th>
                                <th>Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="ordersBody">
                            <!-- Orders will be loaded here -->
                        </tbody>
                    </table>
                </div>

                <!-- Pricing Control Tab -->
                <div id="pricing" class="tab-content">
                    <div class="controls">
                        <h3 style="color: var(--brand-green); margin: 0;">Dynamic Pricing Engine</h3>
                        <div class="action-group">
                            <button class="btn btn-primary" onclick="openModal('bulkPriceModal')">📈 Bulk Price Update</button>
                            <button class="btn btn-secondary" onclick="openModal('priceRulesModal')">⚙️ Pricing Rules</button>
                            <button class="btn btn-secondary" onclick="applyMarketAnalysis()">📊 Market Analysis</button>
                            <button class="btn btn-secondary" onclick="exportPricing()">📄 Export Pricing</button>
                        </div>
                    </div>

                    <div class="grid">
                        <div class="card">
                            <h3>💰 Pricing Analytics</h3>
                            <div style="margin-bottom: 16px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Average Margin:</span>
                                    <strong style="color: var(--brand-green);" id="avgMargin">32%</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Highest Margin:</span>
                                    <strong style="color: var(--brand-green);" id="highestMargin">45%</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Lowest Margin:</span>
                                    <strong style="color: var(--accent-orange);" id="lowestMargin">18%</strong>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3>📊 Price Distribution</h3>
                            <div style="margin-bottom: 12px;">
                                <span>A-Grade Average: <strong style="color: var(--brand-green);" id="agradeAvg">$847</strong></span>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 85%;"></div>
                                </div>
                            </div>
                            <div style="margin-bottom: 12px;">
                                <span>B-Grade Average: <strong style="color: var(--brand-green);" id="bgradeAvg">$550</strong></span>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 55%;"></div>
                                </div>
                            </div>
                            <div style="margin-bottom: 12px;">
                                <span>Concentrates Average: <strong style="color: var(--brand-green);" id="concentratesAvg">$23</strong></span>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 23%;"></div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3>🎯 Price Optimization</h3>
                            <p style="color: var(--text-secondary); margin-bottom: 16px;">
                                AI-powered pricing recommendations based on market data, competition, and demand patterns.
                            </p>
                            <button class="btn btn-primary btn-sm" style="width: 100%;" onclick="runPriceOptimization()">
                                🤖 Run AI Optimization
                            </button>
                        </div>
                    </div>

                    <table class="data-table" id="pricingTable">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Current Price</th>
                                <th>Cost Basis</th>
                                <th>Margin %</th>
                                <th>Market Price</th>
                                <th>Recommended</th>
                                <th>Last Updated</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="pricingBody">
                            <!-- Pricing data will be loaded here -->
                        </tbody>
                    </table>
                </div>

                <!-- Partner Management Tab -->
                <div id="partners" class="tab-content">
                    <div class="controls">
                        <h3 style="color: var(--brand-green); margin: 0;">Partner Relationship Management</h3>
                        <div class="action-group">
                            <button class="btn btn-primary" onclick="openModal('addPartnerModal')">👥 Add Partner</button>
                            <button class="btn btn-secondary" onclick="openModal('bulkEmailModal')">📧 Bulk Email</button>
                            <button class="btn btn-secondary" onclick="exportPartners()">📄 Export Partners</button>
                            <button class="btn btn-secondary" onclick="generatePartnerReport()">📊 Partner Report</button>
                            <button class="btn btn-secondary" onclick="openModal('passwordResetModal')">🔑 Password Resets</button>
                        </div>
                    </div>

                    <div class="stats-grid" style="margin-bottom: 30px;">
                        <div class="stat-card">
                            <div class="stat-number" id="totalPartners">0</div>
                            <div class="stat-label">Total Partners</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="activePartners">0</div>
                            <div class="stat-label">Active This Month</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="newPartners">0</div>
                            <div class="stat-label">New This Month</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="avgPartnerRevenue">$0</div>
                            <div class="stat-label">Avg Monthly Revenue</div>
                        </div>
                    </div>

                    <table class="data-table" id="partnersTable">
                        <thead>
                            <tr>
                                <th>Business Info</th>
                                <th>Contact Details</th>
                                <th>Business Type</th>
                                <th>Tier & Status</th>
                                <th>Performance</th>
                                <th>Credit Terms</th>
                                <th>Last Activity</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="partnersBody">
                            <!-- Partners will be loaded here -->
                        </tbody>
                    </table>
                </div>

                <!-- Business Applications Tab -->
                <div id="applications" class="tab-content">
                    <div class="controls">
                        <h3 style="color: var(--brand-green); margin: 0;">Business Application Review Center</h3>
                        <div class="action-group">
                            <button class="btn btn-primary" onclick="refreshApplications()">🔄 Refresh Applications</button>
                            <button class="btn btn-secondary" onclick="exportApplications()">📄 Export Applications</button>
                            <button class="btn btn-admin" onclick="bulkApplicationAction()">📦 Bulk Actions</button>
                            <button class="btn btn-secondary" onclick="openModal('applicationNotificationsModal')">🔔 Notifications</button>
                        </div>
                    </div>

                    <div class="stats-grid" style="margin-bottom: 30px;">
                        <div class="stat-card">
                            <div class="stat-number" id="totalApplications">0</div>
                            <div class="stat-label">Total Applications</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="pendingApplications">0</div>
                            <div class="stat-label">Pending Review</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="approvedApplications">0</div>
                            <div class="stat-label">Approved</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="rejectedApplications">0</div>
                            <div class="stat-label">Rejected</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="avgReviewTime">0</div>
                            <div class="stat-label">Avg Review Time (hrs)</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="todaysApplications">0</div>
                            <div class="stat-label">Today's Applications</div>
                        </div>
                    </div>

                    <!-- Filter Controls -->
                    <div class="controls" style="margin-bottom: 20px;">
                        <div class="search-group">
                            <input type="text" class="search-input" placeholder="Search applications..." onkeyup="filterApplications(this.value)">
                            <div class="filter-buttons">
                                <button class="filter-btn active" onclick="filterApplicationsByStatus('all')">All</button>
                                <button class="filter-btn" onclick="filterApplicationsByStatus('pending')">Pending</button>
                                <button class="filter-btn" onclick="filterApplicationsByStatus('approved')">Approved</button>
                                <button class="filter-btn" onclick="filterApplicationsByStatus('rejected')">Rejected</button>
                                <button class="filter-btn" onclick="filterApplicationsByStatus('today')">Today</button>
                            </div>
                        </div>
                        <div class="action-group">
                            <select class="editable" style="width: auto;" onchange="sortApplications(this.value)">
                                <option value="newest">Newest First</option>
                                <option value="oldest">Oldest First</option>
                                <option value="businessName">Business Name</option>
                                <option value="volume">Monthly Volume</option>
                            </select>
                        </div>
                    </div>

                    <table class="data-table" id="applicationsTable">
                        <thead>
                            <tr>
                                <th>Application ID</th>
                                <th>Business Information</th>
                                <th>Contact Details</th>
                                <th>Business Type & Volume</th>
                                <th>Submission Date</th>
                                <th>Status</th>
                                <th>Documents</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="applicationsBody">
                            <!-- Applications will be loaded here -->
                        </tbody>
                    </table>
                </div>

                <!-- Analytics Tab -->
                <div id="analytics" class="tab-content">
                    <div class="controls">
                        <h3 style="color: var(--brand-green); margin: 0;">Advanced Analytics & Reporting</h3>
                        <div class="action-group">
                            <select class="editable" style="width: auto;" onchange="updateAnalyticsTimeframe(this.value)">
                                <option value="30">Last 30 Days</option>
                                <option value="90">Last 90 Days</option>
                                <option value="365">This Year</option>
                                <option value="custom">Custom Range</option>
                            </select>
                            <button class="btn btn-secondary" onclick="refreshAnalytics()">🔄 Refresh</button>
                            <button class="btn btn-secondary" onclick="exportAnalytics()">📊 Export Report</button>
                            <button class="btn btn-primary" onclick="generateExecutiveReport()">📋 Executive Report</button>
                        </div>
                    </div>

                    <div class="stats-grid" style="margin-bottom: 30px;">
                        <div class="stat-card">
                            <div class="stat-number" id="analyticsRevenue">$0</div>
                            <div class="stat-label">Total Revenue</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="analyticsOrders">0</div>
                            <div class="stat-label">Total Orders</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="analyticsAvgOrder">$0</div>
                            <div class="stat-label">Avg Order Value</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="analyticsGrowthRate">0%</div>
                            <div class="stat-label">Growth Rate</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="analyticsFulfillmentRate">0%</div>
                            <div class="stat-label">Fulfillment Rate</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="analyticsAvgDeliveryTime">0</div>
                            <div class="stat-label">Avg Delivery Time (Days)</div>
                        </div>
                    </div>

                    <div class="grid">
                        <div class="chart-container">
                            <h3 class="chart-title">📈 Order & Revenue Trends</h3>
                            <div style="height: 250px; background: var(--surface-dark); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--text-primary); position: relative;">
                                <div id="orderTrendChart" style="width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: space-between; padding: 20px;">
                                    <div style="display: flex; justify-content: space-between; font-size: 12px; color: var(--text-muted);">
                                        <span>Revenue ($)</span>
                                        <span>Orders (#)</span>
                                    </div>
                                    <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; height: 180px; align-items: end;">
                                        <div style="background: linear-gradient(180deg, var(--brand-green), var(--brand-green-dark)); height: 60%; border-radius: 2px;"></div>
                                        <div style="background: linear-gradient(180deg, var(--brand-green), var(--brand-green-dark)); height: 45%; border-radius: 2px;"></div>
                                        <div style="background: linear-gradient(180deg, var(--brand-green), var(--brand-green-dark)); height: 80%; border-radius: 2px;"></div>
                                        <div style="background: linear-gradient(180deg, var(--brand-green), var(--brand-green-dark)); height: 100%; border-radius: 2px;"></div>
                                        <div style="background: linear-gradient(180deg, var(--brand-green), var(--brand-green-dark)); height: 35%; border-radius: 2px;"></div>
                                        <div style="background: linear-gradient(180deg, var(--brand-green), var(--brand-green-dark)); height: 70%; border-radius: 2px;"></div>
                                        <div style="background: linear-gradient(180deg, var(--brand-green), var(--brand-green-dark)); height: 55%; border-radius: 2px;"></div>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; font-size: 10px; color: var(--text-muted);">
                                        <span>Week 1</span>
                                        <span>Week 2</span>
                                        <span>Week 3</span>
                                        <span>Week 4</span>
                                        <span>Week 5</span>
                                        <span>Week 6</span>
                                        <span>Week 7</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="chart-container">
                            <h3 class="chart-title">📦 Fulfillment Performance</h3>
                            <div id="fulfillmentMetrics">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 12px; padding: 8px; background: var(--surface-elevated); border-radius: 6px;">
                                    <span>Orders with Tracking:</span>
                                    <strong style="color: var(--brand-green);" id="ordersWithTrackingPercent">100%</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 12px; padding: 8px; background: var(--surface-elevated); border-radius: 6px;">
                                    <span>Same-Day Processing:</span>
                                    <strong style="color: var(--brand-green);" id="sameDayProcessing">85%</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 12px; padding: 8px; background: var(--surface-elevated); border-radius: 6px;">
                                    <span>On-Time Delivery Rate:</span>
                                    <strong style="color: var(--brand-green);" id="onTimeDelivery">92%</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 12px; padding: 8px; background: var(--surface-elevated); border-radius: 6px;">
                                    <span>Customer Satisfaction:</span>
                                    <strong style="color: var(--brand-green);" id="customerSatisfaction">4.8/5</strong>
                                </div>
                            </div>
                        </div>

                        <div class="chart-container">
                            <h3 class="chart-title">🏆 Top Products by Revenue</h3>
                            <div id="topProductsAnalytics">
                                <!-- Will be populated by updateTopProductsAnalytics() -->
                            </div>
                        </div>

                        <div class="chart-container">
                            <h3 class="chart-title">👥 Partner Performance Analysis</h3>
                            <div id="partnerPerformanceAnalytics">
                                <!-- Will be populated by updatePartnerPerformanceAnalytics() -->
                            </div>
                        </div>

                        <div class="chart-container">
                            <h3 class="chart-title">📊 Order Status Distribution</h3>
                            <div style="height: 200px; display: flex; align-items: center; justify-content: center; position: relative;">
                                <div id="orderStatusChart" style="width: 100%; height: 100%; display: flex; flex-direction: column; padding: 20px;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                                        <div style="text-align: center;">
                                            <div style="width: 60px; height: 60px; background: conic-gradient(var(--brand-green) 0deg 180deg, var(--accent-blue) 180deg 270deg, var(--accent-orange) 270deg 315deg, var(--accent-red) 315deg 360deg); border-radius: 50%; margin: 0 auto 8px;"></div>
                                            <small style="color: var(--text-primary);">Current Orders</small>
                                        </div>
                                        <div>
                                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                                <div style="width: 12px; height: 12px; background: var(--brand-green); border-radius: 50%;"></div>
                                                <span style="font-size: 12px;">Delivered (<span id="deliveredCount">0</span>)</span>
                                            </div>
                                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                                <div style="width: 12px; height: 12px; background: var(--accent-blue); border-radius: 50%;"></div>
                                                <span style="font-size: 12px;">Shipped (<span id="shippedCount">0</span>)</span>
                                            </div>
                                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                                <div style="width: 12px; height: 12px; background: var(--accent-orange); border-radius: 50%;"></div>
                                                <span style="font-size: 12px;">Processing (<span id="processingCount">0</span>)</span>
                                            </div>
                                            <div style="display: flex; align-items: center; gap: 8px;">
                                                <div style="width: 12px; height: 12px; background: var(--accent-red); border-radius: 50%;"></div>
                                                <span style="font-size: 12px;">Pending (<span id="pendingCount">0</span>)</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="chart-container">
                            <h3 class="chart-title">📅 Weekly Order Volume</h3>
                            <div id="weeklyOrderVolume">
                                <div style="margin-bottom: 16px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                        <span>This Week:</span>
                                        <strong style="color: var(--brand-green);" id="thisWeekOrders">5 orders</strong>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 83%;"></div>
                                    </div>
                                </div>
                                <div style="margin-bottom: 16px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                        <span>Last Week:</span>
                                        <strong style="color: var(--text-secondary);" id="lastWeekOrders">3 orders</strong>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 50%; background: var(--text-secondary);"></div>
                                    </div>
                                </div>
                                <div style="margin-bottom: 16px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                        <span>Monthly Average:</span>
                                        <strong style="color: var(--accent-blue);" id="monthlyAvgOrders">12 orders</strong>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 100%; background: var(--accent-blue);"></div>
                                    </div>
                                </div>
                                <div style="margin-top: 12px; padding: 8px; background: var(--surface-elevated); border-radius: 6px; text-align: center;">
                                    <span style="color: var(--brand-green); font-weight: bold;" id="weeklyGrowth">+67% vs last week</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Tab -->
                <div id="settings" class="tab-content">
                    <div class="controls">
                        <h3 style="color: var(--brand-green); margin: 0;">System Configuration</h3>
                        <div class="action-group">
                            <button class="btn btn-primary" onclick="saveSettings()">���� Save Settings</button>
                            <button class="btn btn-secondary" onclick="backupSystem()">📦 Backup System</button>
                            <button class="btn btn-secondary" onclick="exportLogs()">📋 Export Logs</button>
                            <button class="btn btn-danger" onclick="resetSystem()">🔄 Reset System</button>
                        </div>
                    </div>

                    <div class="grid">
                        <div class="card">
                            <h3>🏢 Company Information</h3>
                            <div class="form-group">
                                <label>Company Name</label>
                                <input type="text" class="editable" value="Faded Skies Wholesale" style="width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>Contact Email</label>
                                <input type="email" class="editable" value="info@fadedskies.com" style="width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>Phone Number</label>
                                <input type="tel" class="editable" value="(210) 835-7834" style="width: 100%;">
                            </div>
                        </div>

                        <div class="card">
                            <h3>⚙️ System Configuration</h3>
                            <div class="form-group">
                                <label>Auto-Sync Interval (minutes)</label>
                                <input type="number" class="editable" value="45" style="width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>Low Stock Alert Threshold</label>
                                <input type="number" class="editable" value="10" style="width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>Order Auto-Approval</label>
                                <select class="editable" style="width: 100%;">
                                    <option>Manual Approval</option>
                                    <option>Auto-Approve Trusted Partners</option>
                                    <option>Auto-Approve All</option>
                                </select>
                            </div>
                        </div>

                        <div class="card">
                            <h3>🔐 Security Settings</h3>
                            <div class="form-group">
                                <label>Session Timeout (hours)</label>
                                <input type="number" class="editable" value="8" style="width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>Two-Factor Authentication</label>
                                <select class="editable" style="width: 100%;">
                                    <option>Disabled</option>
                                    <option>Required for Admin</option>
                                    <option>Required for All</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>IP Whitelist</label>
                                <textarea class="editable" rows="3" style="width: 100%;" placeholder="Enter IP addresses, one per line"></textarea>
                            </div>
                        </div>

                        <div class="card">
                            <h3>🔄 Portal Integration</h3>
                            <div style="margin-bottom: 16px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Public Website Status:</span>
                                    <strong style="color: var(--brand-green);">✅ Connected</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Partner Portal Status:</span>
                                    <strong style="color: var(--brand-green);">✅ Synced</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Last Sync:</span>
                                    <strong style="color: var(--text-secondary);" id="lastSync">2 minutes ago</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Active Partner Sessions:</span>
                                    <strong style="color: var(--brand-green);" id="activeSessions">0</strong>
                                </div>
                            </div>
                            <button class="btn btn-primary btn-sm" style="width: 100%; margin-bottom: 8px;" onclick="forceSyncPortals()">
                                🔄 Force Sync All Portals
                            </button>
                            <button class="btn btn-secondary btn-sm" style="width: 100%;" onclick="viewPartnerPortalLogs()">
                                📋 View Portal Activity
                            </button>
                        </div>

                        <div class="card">
                            <h3>🛡️ Partner Portal Security</h3>
                            <div style="margin-bottom: 16px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Failed Login Attempts (24h):</span>
                                    <strong style="color: var(--accent-orange);">3</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Password Resets Pending:</span>
                                    <strong style="color: var(--text-secondary);" id="pendingResets">0</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Two-Factor Enabled:</span>
                                    <strong style="color: var(--accent-orange);">0/3 Partners</strong>
                                </div>
                            </div>
                            <button class="btn btn-admin btn-sm" style="width: 100%; margin-bottom: 8px;" onclick="openModal('passwordResetModal')">
                                🔑 Manage Password Resets
                            </button>
                            <button class="btn btn-secondary btn-sm" style="width: 100%;" onclick="viewSecurityLogs()">
                                🔒 Security Audit Log
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Add Product Modal -->
    <div id="addProductModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add New Product 🌿</h3>
                <button class="modal-close" onclick="closeModal('addProductModal')">×</button>
            </div>
            <form onsubmit="addProduct(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label>Grade/Type *</label>
                        <select id="newGrade" required>
                            <option value="">Select grade</option>
                            <option value="A-GRADE">A-Grade</option>
                            <option value="B-GRADE">B-Grade</option>
                            <option value="ROSIN">Rosin</option>
                            <option value="VAPE">Vape</option>
                            <option value="BULK">Bulk</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Status *</label>
                        <select id="newStatus" required>
                            <option value="">Select status</option>
                            <option value="AVAILABLE">Available</option>
                            <option value="COMING SOON">Coming Soon</option>
                            <option value="SOLD OUT">Sold Out</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Strain Name *</label>
                    <input type="text" id="newStrain" required placeholder="e.g., Blue Runtz, OG Kush">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>THCA % *</label>
                        <input type="number" id="newThca" step="0.1" required placeholder="e.g., 31.6">
                    </div>
                    <div class="form-group">
                        <label>Price ($) *</label>
                        <input type="number" id="newPrice" step="0.01" required placeholder="e.g., 723.00">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Stock Quantity</label>
                        <input type="number" id="newStock" placeholder="Available quantity">
                    </div>
                    <div class="form-group">
                        <label>Type</label>
                        <select id="newType">
                            <option value="Indica">Indica</option>
                            <option value="Sativa">Sativa</option>
                            <option value="Hybrid">Hybrid</option>
                            <option value="Concentrate">Concentrate</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Cost Basis ($)</label>
                    <input type="number" id="newCostBasis" step="0.01" placeholder="Internal cost for margin calculation">
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="newDescription" rows="3" placeholder="Product description, notes, etc."></textarea>
                </div>
                <div class="form-group">
                    <label>Photo</label>
                    <input type="file" id="newPhoto" accept="image/*" onchange="previewProductPhoto(event)">
                    <div id="photoPreview" style="margin-top:10px;"></div>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">Add Product & Sync to Portal ✨</button>
            </form>
        </div>
    </div>

    <!-- Bulk Price Update Modal -->
    <div id="bulkPriceModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Bulk Price Update 📈</h3>
                <button class="modal-close" onclick="closeModal('bulkPriceModal')">×</button>
            </div>
            <form onsubmit="processBulkPriceUpdate(event)">
                <div class="form-group">
                    <label>Update Type</label>
                    <select id="updateType" onchange="toggleUpdateFields()" required>
                        <option value="percentage">Percentage Change</option>
                        <option value="fixed">Fixed Amount Change</option>
                        <option value="margin">Target Margin</option>
                    </select>
                </div>
                
                <div class="form-group" id="percentageField">
                    <label>Percentage Change (+ or -)</label>
                    <input type="number" id="percentageChange" step="0.1" placeholder="e.g., +5 or -10">
                    <small style="color: var(--text-muted);">Use + for increase, - for decrease</small>
                </div>
                
                <div class="form-group" id="fixedField" style="display: none;">
                    <label>Fixed Amount Change ($)</label>
                    <input type="number" id="fixedChange" step="0.01" placeholder="e.g., +50.00 or -25.00">
                </div>
                
                <div class="form-group" id="marginField" style="display: none;">
                    <label>Target Margin (%)</label>
                    <input type="number" id="targetMargin" step="0.1" placeholder="e.g., 35">
                </div>
                
                <div class="form-group">
                    <label>Apply to:</label>
                    <select id="applyTo">
                        <option value="all">All Products</option>
                        <option value="available">Available Only</option>
                        <option value="category">Selected Category</option>
                        <option value="below-margin">Below Target Margin</option>
                    </select>
                </div>
                
                <div class="form-group" id="categoryField" style="display: none;">
                    <label>Select Category</label>
                    <select id="categorySelect">
                        <option value="A-GRADE">A-Grade Flower</option>
                        <option value="B-GRADE">B-Grade Flower</option>
                        <option value="ROSIN">Rosin/Concentrates</option>
                        <option value="VAPE">Vapes</option>
                        <option value="BULK">Bulk Orders</option>
                    </select>
                </div>
                
                <button type="submit" class="btn btn-primary" style="width: 100%;">Apply Price Update & Sync 🚀</button>
            </form>
        </div>
    </div>

    <!-- Create Order Modal -->
    <div id="createOrderModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Create New Order 📋</h3>
                <button class="modal-close" onclick="closeModal('createOrderModal')">×</button>
            </div>
            <form onsubmit="createOrder(event)">
                <div class="form-group">
                    <label>Partner Email *</label>
                    <input type="email" id="orderPartnerEmail" required placeholder="partner@example.com">
                </div>
                <div class="form-group">
                    <label>Partner Name *</label>
                    <input type="text" id="orderPartnerName" required placeholder="Business Name">
                </div>
                <div class="form-group">
                    <label>Order Items *</label>
                    <textarea id="orderItems" required rows="4" placeholder="Product 1 (x2), Product 2 (x1), etc."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Total Amount ($) *</label>
                        <input type="number" id="orderTotal" step="0.01" required placeholder="1234.56">
                    </div>
                    <div class="form-group">
                        <label>Priority</label>
                        <select id="orderPriority">
                            <option value="NORMAL">Normal</option>
                            <option value="HIGH">High</option>
                            <option value="LOW">Low</option>
                        </select>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">Create Order 🚀</button>
            </form>
        </div>
    </div>

    <!-- Bulk Import Modal -->
    <div id="bulkImportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Bulk Import Products 📥</h3>
                <button class="modal-close" onclick="closeModal('bulkImportModal')">×</button>
            </div>
            <div>
                <div class="form-group">
                    <label>Upload CSV File</label>
                    <input type="file" id="csvFile" accept=".csv" onchange="handleFileUpload(this)">
                    <small style="color: var(--text-muted);">CSV should include: grade, strain, thca, price, status, stock, type</small>
                </div>
                <div class="form-group">
                    <label>Or Paste CSV Data</label>
                    <textarea id="csvData" rows="8" placeholder="grade,strain,thca,price,status,stock,type
A-GRADE,Purple Haze,28.5,850,AVAILABLE,25,Sativa
B-GRADE,Blue Dream,26.1,550,AVAILABLE,15,Hybrid"></textarea>
                </div>
                <button class="btn btn-primary" onclick="processBulkImport()" style="width: 100%;">Import Products 📦</button>
            </div>
        </div>
    </div>

    <!-- Add Partner Modal -->
    <div id="addPartnerModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3 class="modal-title">Add New Partner 👥</h3>
                <button class="modal-close" onclick="closeModal('addPartnerModal')">×</button>
            </div>
            <form onsubmit="addPartner(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label>Business Name *</label>
                        <input type="text" id="newPartnerBusinessName" required placeholder="e.g., Green Valley Dispensary">
                    </div>
                    <div class="form-group">
                        <label>Contact Name *</label>
                        <input type="text" id="newPartnerContactName" required placeholder="e.g., John Smith">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Email Address *</label>
                        <input type="email" id="newPartnerEmail" required placeholder="partner@business.com">
                    </div>
                    <div class="form-group">
                        <label>Phone Number *</label>
                        <input type="tel" id="newPartnerPhone" required placeholder="(555) 123-4567">
                    </div>
                </div>
                <div class="form-group">
                    <label>Business Address *</label>
                    <input type="text" id="newPartnerAddress" required placeholder="123 Main St, City, State 12345">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Business Type *</label>
                        <select id="newPartnerBusinessType" required>
                            <option value="">Select business type</option>
                            <option value="Licensed Dispensary">Licensed Dispensary</option>
                            <option value="Smoke Shop">Smoke Shop</option>
                            <option value="CBD Store">CBD Store</option>
                            <option value="Delivery Service">Delivery Service</option>
                            <option value="Distributor">Distributor</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>License Number *</label>
                        <input type="text" id="newPartnerLicense" required placeholder="CDPH-10001234">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Partner Tier</label>
                        <select id="newPartnerTier">
                            <option value="Bronze">Bronze (5% discount)</option>
                            <option value="Silver">Silver (10% discount)</option>
                            <option value="Gold">Gold (15% discount)</option>
                            <option value="Platinum">Platinum (20% discount)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Credit Limit ($)</label>
                        <input type="number" id="newPartnerCreditLimit" placeholder="25000" step="100">
                        <small style="color: var(--text-muted);">Credit limit for Net payment terms only</small>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Payment Terms</label>
                        <select id="newPartnerPaymentTerms">
                            <option value="Immediate Payment" selected>Immediate Payment</option>
                            <option value="Net 15">Net 15 Days</option>
                            <option value="Net 30">Net 30 Days</option>
                            <option value="Net 60">Net 60 Days</option>
                            <option value="Prepaid Only">Prepaid Only</option>
                        </select>
                        <small style="color: var(--text-muted);">Default: Immediate payment required on all orders</small>
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <select id="newPartnerStatus">
                            <option value="Active">Active</option>
                            <option value="Pending">Pending Approval</option>
                            <option value="Review">Under Review</option>
                            <option value="Suspended">Suspended</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Notes</label>
                    <textarea id="newPartnerNotes" rows="3" placeholder="Internal notes about this partner..."></textarea>
                </div>
                <div style="background: var(--surface-elevated); padding: 16px; border-radius: 8px; margin-bottom: 20px;">
                    <h4 style="color: var(--brand-green); margin-bottom: 8px;">🔑 Portal Access</h4>
                    <p style="color: var(--text-muted); font-size: 14px; margin-bottom: 12px;">
                        A secure account will be created for this partner to access the wholesale portal. 
                        Login credentials will be sent via email with password reset instructions.
                    </p>
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <input type="checkbox" id="sendWelcomeEmail" checked>
                        <span>Send welcome email with portal access instructions</span>
                    </label>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">Add Partner & Send Portal Access ✨</button>
            </form>
        </div>
    </div>

    <!-- Password Reset Management Modal -->
    <div id="passwordResetModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3 class="modal-title">Password Reset Management 🔑</h3>
                <button class="modal-close" onclick="closeModal('passwordResetModal')">×</button>
            </div>
            <div>
                <div style="display: flex; gap: 16px; margin-bottom: 24px;">
                    <button class="btn btn-primary" onclick="generatePartnerResetLinks()">🔗 Generate Reset Links</button>
                    <button class="btn btn-secondary" onclick="sendBulkPasswordResets()">📧 Send Bulk Reset Emails</button>
                    <button class="btn btn-secondary" onclick="refreshPasswordResetTable()">🔄 Refresh</button>
                </div>
                
                <table class="data-table" id="passwordResetTable">
                    <thead>
                        <tr>
                            <th>Partner</th>
                            <th>Email</th>
                            <th>Reset Status</th>
                            <th>Reset Token</th>
                            <th>Expires</th>
                            <th>Last Login</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="passwordResetBody">
                        <!-- Password reset data will be loaded here -->
                    </tbody>
                </table>
                
                <div style="margin-top: 24px; padding: 16px; background: var(--surface-elevated); border-radius: 8px;">
                    <h4 style="color: var(--brand-green); margin-bottom: 12px;">🛡️ Security Guidelines</h4>
                    <ul style="color: var(--text-muted); font-size: 14px; line-height: 1.6;">
                        <li>Reset tokens expire after 24 hours for security</li>
                        <li>Partners can request resets through the portal login page</li>
                        <li>All reset attempts are logged for security auditing</li>
                        <li>Suspended partners cannot reset passwords</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Bulk Email Modal -->
    <div id="bulkEmailModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3 class="modal-title">Bulk Email Partners 📧</h3>
                <button class="modal-close" onclick="closeModal('bulkEmailModal')">×</button>
            </div>
            <form onsubmit="sendBulkEmail(event)">
                <div class="form-group">
                    <label>Recipients</label>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 12px;">
                        <button type="button" class="filter-btn active" onclick="toggleEmailRecipients('all')">All Partners</button>
                        <button type="button" class="filter-btn" onclick="toggleEmailRecipients('active')">Active Only</button>
                        <button type="button" class="filter-btn" onclick="toggleEmailRecipients('gold')">Gold Tier</button>
                        <button type="button" class="filter-btn" onclick="toggleEmailRecipients('silver')">Silver Tier</button>
                        <button type="button" class="filter-btn" onclick="toggleEmailRecipients('bronze')">Bronze Tier</button>
                    </div>
                    <div id="selectedRecipients" style="background: var(--surface-elevated); padding: 12px; border-radius: 6px; font-size: 14px; color: var(--text-muted);">
                        All partners selected (3 recipients)
                    </div>
                </div>
                <div class="form-group">
                    <label>Email Template</label>
                    <select id="emailTemplate" onchange="loadEmailTemplate()">
                        <option value="custom">Custom Message</option>
                        <option value="new_products">New Products Announcement</option>
                        <option value="price_update">Price Update Notification</option>
                        <option value="inventory_alert">Low Inventory Alert</option>
                        <option value="payment_reminder">Payment Reminder</option>
                        <option value="newsletter">Monthly Newsletter</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Subject Line *</label>
                    <input type="text" id="emailSubject" required placeholder="Enter email subject">
                </div>
                <div class="form-group">
                    <label>Message *</label>
                    <textarea id="emailMessage" required rows="8" placeholder="Enter your message here..."></textarea>
                </div>
                <div style="display: flex; gap: 12px;">
                    <button type="button" class="btn btn-secondary" onclick="previewEmail()" style="flex: 1;">👁️ Preview</button>
                    <button type="submit" class="btn btn-primary" style="flex: 2;">📧 Send Email</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Tracking Modal -->
    <div id="addTrackingModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3 class="modal-title">Add Tracking Information 📦</h3>
                <button class="modal-close" onclick="closeModal('addTrackingModal')">×</button>
            </div>
            <form onsubmit="saveTrackingInfo(event)">
                <input type="hidden" id="trackingOrderId">
                <div class="form-group">
                    <label>Order Details</label>
                    <div id="trackingOrderDetails" style="background: var(--surface-elevated); padding: 12px; border-radius: 6px; font-size: 14px; color: var(--text-muted);">
                        <!-- Order details will be populated here -->
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Tracking Number *</label>
                        <input type="text" id="trackingNumber" required placeholder="e.g., FS-TRK-12345678">
                    </div>
                    <div class="form-group">
                        <label>Carrier *</label>
                        <select id="trackingCarrier" required>
                            <option value="">Select carrier</option>
                            <option value="FedEx">FedEx</option>
                            <option value="UPS">UPS</option>
                            <option value="USPS">USPS</option>
                            <option value="DHL">DHL</option>
                            <option value="OnTrac">OnTrac</option>
                            <option value="Local Delivery">Local Delivery</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Estimated Delivery Date</label>
                        <input type="date" id="estimatedDelivery">
                    </div>
                    <div class="form-group">
                        <label>Update Status to:</label>
                        <select id="newTrackingStatus">
                            <option value="SHIPPED">Shipped</option>
                            <option value="PROCESSING">Keep as Processing</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Tracking URL (Optional)</label>
                    <input type="url" id="trackingUrl" placeholder="https://www.fedex.com/track?number=...">
                    <small style="color: var(--text-muted);">Full tracking link for customer convenience</small>
                </div>
                <div class="form-group">
                    <label>Shipping Notes</label>
                    <textarea id="shippingNotes" rows="3" placeholder="Additional shipping information or special instructions..."></textarea>
                </div>
                <div style="background: var(--surface-elevated); padding: 16px; border-radius: 8px; margin-bottom: 20px;">
                    <h4 style="color: var(--brand-green); margin-bottom: 8px;">📧 Customer Notification</h4>
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <input type="checkbox" id="notifyCustomer" checked>
                        <span>Send tracking notification email to customer</span>
                    </label>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">Save Tracking Info & Notify Customer 🚀</button>
            </form>
        </div>
    </div>

    <!-- Order Details Modal -->
    <div id="orderDetailsModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3 class="modal-title">Order Details 📋</h3>
                <button class="modal-close" onclick="closeModal('orderDetailsModal')">×</button>
            </div>
            <div id="orderDetailsContent">
                <!-- Order details will be populated here -->
            </div>
        </div>
    </div>

    <!-- Customer Tracking Portal Modal -->
    <div id="customerTrackingModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3 class="modal-title">Customer Order Tracking 🔍</h3>
                <button class="modal-close" onclick="closeModal('customerTrackingModal')">×</button>
            </div>
            <div>
                <div class="form-group">
                    <label>Enter Order ID or Tracking Number</label>
                    <div style="display: flex; gap: 12px;">
                        <input type="text" id="customerLookupInput" placeholder="ORD-001 or FS-TRK-12345678" style="flex: 1;">
                        <button class="btn btn-primary" onclick="lookupCustomerOrder()">🔍 Track Order</button>
                    </div>
                </div>
                <div id="customerTrackingResults" style="margin-top: 20px;">
                    <!-- Customer tracking results will appear here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Application Review Modal -->
    <div id="applicationReviewModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3 class="modal-title">📋 Review Business Application</h3>
                <button class="modal-close" onclick="closeModal('applicationReviewModal')">×</button>
            </div>

            <div id="applicationReviewContent">
                <!-- Application content will be populated here -->
            </div>

            <div style="display: flex; gap: 12px; margin-top: 24px; justify-content: flex-end;">
                <button type="button" class="btn btn-secondary" onclick="closeModal('applicationReviewModal')">Close</button>
                <button type="button" class="btn btn-danger" onclick="rejectApplication()">❌ Reject</button>
                <button type="button" class="btn btn-primary" onclick="approveApplication()">✅ Approve</button>
            </div>
        </div>
    </div>

    <!-- Application Notes Modal -->
    <div id="applicationNotesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">📝 Add Review Notes</h3>
                <button class="modal-close" onclick="closeModal('applicationNotesModal')">×</button>
            </div>

            <form onsubmit="submitApplicationAction(event)">
                <div class="form-group">
                    <label for="reviewAction">Action *</label>
                    <select id="reviewAction" required>
                        <option value="">Select action</option>
                        <option value="approve">✅ Approve Application</option>
                        <option value="reject">❌ Reject Application</option>
                        <option value="request_info">📋 Request Additional Information</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="reviewNotes">Review Notes *</label>
                    <textarea id="reviewNotes" rows="4" required placeholder="Enter your review notes, reasons for decision, or additional information requests..."></textarea>
                </div>

                <div id="approvalOptionsSection" class="form-group" style="display: none;">
                    <label for="partnerTier">Partner Tier (if approving)</label>
                    <select id="partnerTier">
                        <option value="starter">Starter Partner</option>
                        <option value="professional">Professional Partner</option>
                        <option value="enterprise">Enterprise Partner</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="adminEmail">Send Email Notification</label>
                    <input type="checkbox" id="sendEmailNotification" checked>
                    <label for="sendEmailNotification" style="display: inline; margin-left: 8px;">Send email to applicant</label>
                </div>

                <div style="display: flex; gap: 12px; margin-top: 24px;">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('applicationNotesModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary" style="flex: 1;">Submit Review</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Application Notifications Modal -->
    <div id="applicationNotificationsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">🔔 Application Notifications</h3>
                <button class="modal-close" onclick="closeModal('applicationNotificationsModal')">×</button>
            </div>

            <div class="controls" style="margin-bottom: 24px;">
                <div class="action-group">
                    <button class="btn btn-secondary" onclick="markAllNotificationsRead()">✅ Mark All Read</button>
                    <button class="btn btn-secondary" onclick="clearOldNotifications()">🗑️ Clear Old</button>
                </div>
            </div>

            <div id="notificationsList" style="max-height: 400px; overflow-y: auto;">
                <!-- Notifications will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Include Shared Data Manager -->
    <script src="shared-data.js"></script>
    <!-- Include Test Functionality -->
    <script src="test-functionality.js"></script>

    <script>
        // Global State Management
        let currentUser = null;
        let nextProductId = 11;
        let isConnectedToPortal = true;
        let syncInterval = null;
        let currentFilter = 'all';
        let currentOrderFilter = 'all';

        // Shared Data - Syncs with public website/partner portal
        let products = [
            {
                id: 1,
                grade: 'A-GRADE',
                strain: 'Purple Cream (EXTC)',
                thca: 31.2,
                price: 983,
                costBasis: 688,
                status: 'COMING SOON',
                stock: 0,
                type: 'Indica',
                lastModified: '2025-06-27T10:30:00Z',
                modifiedBy: 'admin@fadedskies.com',
                photo: '' // Add photo property
            },
            {
                id: 2,
                grade: 'A-GRADE',
                strain: 'Blue Gelatti (EXTC)',
                thca: 29.5,
                price: 964,
                costBasis: 675,
                status: 'AVAILABLE',
                stock: 15,
                type: 'Sativa',
                lastModified: '2025-06-27T09:15:00Z',
                modifiedBy: 'admin@fadedskies.com',
                photo: ''
            },
            {
                id: 3,
                grade: 'A-GRADE',
                strain: 'Candy Gas (EXTC)',
                thca: 31.9,
                price: 804,
                costBasis: 563,
                status: 'AVAILABLE',
                stock: 23,
                type: 'Hybrid',
                lastModified: '2025-06-26T16:45:00Z',
                modifiedBy: 'admin@fadedskies.com',
                photo: ''
            },
            {
                id: 4,
                grade: 'A-GRADE',
                strain: 'OG Kush (IN)',
                thca: 24.1,
                price: 764,
                costBasis: 535,
                status: 'AVAILABLE',
                stock: 47,
                type: 'Hybrid',
                lastModified: '2025-06-26T14:20:00Z',
                modifiedBy: 'admin@fadedskies.com',
                photo: ''
            },
            {
                id: 5,
                grade: 'A-GRADE',
                strain: 'Blue Runtz (IN)',
                thca: 31.6,
                price: 723,
                costBasis: 506,
                status: 'AVAILABLE',
                stock: 32,
                type: 'Indica',
                lastModified: '2025-06-26T11:10:00Z',
                modifiedBy: 'admin@fadedskies.com',
                photo: ''
            },
            {
                id: 6,
                grade: 'B-GRADE',
                strain: 'LCG B (IN)',
                thca: 31.0,
                price: 550,
                costBasis: 385,
                status: 'AVAILABLE',
                stock: 18,
                type: 'Hybrid',
                lastModified: '2025-06-25T08:30:00Z',
                modifiedBy: 'admin@fadedskies.com',
                photo: ''
            },
            {
                id: 7,
                grade: 'B-GRADE',
                strain: 'Illemonati B (IN)',
                thca: 33.1,
                price: 550,
                costBasis: 385,
                status: 'AVAILABLE',
                stock: 12,
                type: 'Sativa',
                lastModified: '2025-06-25T07:45:00Z',
                modifiedBy: 'admin@fadedskies.com',
                photo: ''
            },
            {
                id: 8,
                grade: 'ROSIN',
                strain: 'Cherry Grease Rosin (T1)',
                thca: 0,
                price: 16,
                costBasis: 11,
                status: 'AVAILABLE',
                stock: 250,
                type: 'Concentrate',
                lastModified: '2025-06-24T13:20:00Z',
                modifiedBy: 'admin@fadedskies.com',
                photo: ''
            },
            {
                id: 9,
                grade: 'VAPE',
                strain: 'Sour Diesel Vape (2g)',
                thca: 0,
                price: 29,
                costBasis: 20,
                status: 'AVAILABLE',
                stock: 85,
                type: 'Concentrate',
                lastModified: '2025-06-24T10:15:00Z',
                modifiedBy: 'admin@fadedskies.com',
                photo: ''
            },
            {
                id: 10,
                grade: 'BULK',
                strain: 'Zaza Runtz Big (EXTC)',
                thca: 28.5,
                price: 1205,
                costBasis: 844,
                status: 'AVAILABLE',
                stock: 8,
                type: 'Hybrid',
                lastModified: '2025-06-23T15:30:00Z',
                modifiedBy: 'admin@fadedskies.com',
                photo: ''
            }
        ];

        let orders = [
            {
                id: 'ORD-001',
                partner: 'partner@store.com',
                partnerName: 'Green Valley Dispensary',
                items: 'Blue Gelatti (x2), Candy Gas (x1)',
                total: 2732.00,
                status: 'SHIPPED',
                priority: 'HIGH',
                date: '2025-06-10',
                createdAt: '2025-06-10T09:30:00Z',
                trackingNumber: 'FS-TRK-24681357',
                carrier: 'FedEx',
                estimatedDelivery: '2025-06-30',
                paymentStatus: 'Paid',
                shippingAddress: '123 Cannabis St, Los Angeles, CA 90210',
                orderNotes: 'Priority delivery requested',
                statusHistory: [
                    { status: 'PENDING', timestamp: '2025-06-10T09:30:00Z', note: 'Order placed' },
                    { status: 'PROCESSING', timestamp: '2025-06-10T11:15:00Z', note: 'Payment confirmed, preparing shipment' },
                    { status: 'SHIPPED', timestamp: '2025-06-10T16:45:00Z', note: 'Package shipped via FedEx' }
                ]
            },
            {
                id: 'ORD-002',
                partner: 'dispensary@example.com',
                partnerName: 'Cali Dreams Shop',
                items: 'OG Kush (x5), Blue Runtz (x3)',
                total: 6035.00,
                status: 'PROCESSING',
                priority: 'NORMAL',
                date: '2025-06-09',
                createdAt: '2025-06-09T14:20:00Z',
                trackingNumber: null,
                carrier: null,
                estimatedDelivery: null,
                paymentStatus: 'Paid',
                shippingAddress: '456 Hemp Ave, San Francisco, CA 94102',
                orderNotes: 'Standard processing',
                statusHistory: [
                    { status: 'PENDING', timestamp: '2025-06-09T14:20:00Z', note: 'Order placed' },
                    { status: 'PROCESSING', timestamp: '2025-06-09T15:30:00Z', note: 'Payment confirmed, preparing order' }
                ]
            },
            {
                id: 'ORD-003',
                partner: 'hemp@heaven.co',
                partnerName: 'Hemp Heaven',
                items: 'Cherry Grease Rosin (x10), Sour Diesel Vape (x20)',
                total: 740.00,
                status: 'DELIVERED',
                priority: 'LOW',
                date: '2025-06-08',
                createdAt: '2025-06-08T11:45:00Z',
                trackingNumber: 'FS-TRK-13579246',
                carrier: 'UPS',
                estimatedDelivery: '2025-06-28',
                paymentStatus: 'Paid',
                shippingAddress: '789 CBD Blvd, Denver, CO 80202',
                orderNotes: 'Delivered successfully',
                statusHistory: [
                    { status: 'PENDING', timestamp: '2025-06-08T11:45:00Z', note: 'Order placed' },
                    { status: 'PROCESSING', timestamp: '2025-06-08T13:20:00Z', note: 'Payment confirmed' },
                    { status: 'SHIPPED', timestamp: '2025-06-08T18:30:00Z', note: 'Package shipped via UPS' },
                    { status: 'DELIVERED', timestamp: '2025-06-28T14:15:00Z', note: 'Package delivered successfully' }
                ]
            }
        ];

        let partners = [
            {
                id: 1,
                email: 'partner@store.com',
                businessName: 'Green Valley Dispensary',
                contactName: 'Michael Rodriguez',
                phone: '(555) 123-4567',
                address: '123 Cannabis St, Los Angeles, CA 90210',
                businessType: 'Licensed Dispensary',
                tier: 'Gold',
                status: 'Active',
                totalOrders: 23,
                totalRevenue: 18450,
                lastOrder: '2025-06-10',
                joinDate: '2024-01-15',
                licenseNumber: 'CDPH-10001234',
                creditLimit: 25000,
                paymentTerms: 'Net 30',
                discountRate: 15,
                notes: 'Premium partner with excellent payment history',
                lastLogin: '2025-06-10T08:30:00Z',
                passwordResetToken: null,
                passwordResetExpires: null,
                createdAt: '2024-01-15T10:00:00Z',
                modifiedAt: '2025-06-10T08:30:00Z'
            },
            {
                id: 2,
                email: 'dispensary@example.com',
                businessName: 'Cali Dreams Shop',
                contactName: 'Sarah Chen',
                phone: '(555) 987-6543',
                address: '456 Hemp Ave, San Francisco, CA 94102',
                businessType: 'Smoke Shop',
                tier: 'Silver',
                status: 'Active',
                totalOrders: 15,
                totalRevenue: 12300,
                lastOrder: '2025-06-08',
                joinDate: '2024-03-22',
                licenseNumber: 'CDPH-10002345',
                creditLimit: 15000,
                paymentTerms: 'Immediate Payment',
                discountRate: 10,
                notes: 'Growing partnership with consistent orders',
                lastLogin: '2025-06-08T14:20:00Z',
                passwordResetToken: null,
                passwordResetExpires: null,
                createdAt: '2024-03-22T12:00:00Z',
                modifiedAt: '2025-06-08T14:20:00Z'
            },
            {
                id: 3,
                email: 'hemp@heaven.co',
                businessName: 'Hemp Heaven',
                contactName: 'David Wilson',
                phone: '(555) 456-7890',
                address: '789 CBD Blvd, Denver, CO 80202',
                businessType: 'CBD Store',
                tier: 'Bronze',
                status: 'Review',
                totalOrders: 8,
                totalRevenue: 5890,
                lastOrder: '2025-06-05',
                joinDate: '2024-11-10',
                licenseNumber: 'CDPH-10003456',
                creditLimit: 5000,
                paymentTerms: 'Immediate Payment',
                discountRate: 5,
                notes: 'New partner under review for credit approval',
                lastLogin: '2025-06-05T16:45:00Z',
                passwordResetToken: null,
                passwordResetExpires: null,
                createdAt: '2024-11-10T09:30:00Z',
                modifiedAt: '2025-06-05T16:45:00Z'
            }
        ];

        let nextPartnerId = 4;

        // Initialize Application
        document.addEventListener('DOMContentLoaded', function() {
            initializeAdminDashboard();
        });

        // Load system logos
        function loadSystemLogos() {
            try {
                const logos = window.sharedDataManager.getLogos();
                console.log('📷 Loading system logos:', logos);

                // Update admin header logo
                const adminLogo = document.getElementById('adminHeaderLogo');
                if (adminLogo && logos.adminHeader) {
                    adminLogo.src = logos.adminHeader;
                    adminLogo.style.display = 'inline-block';
                    console.log('✅ Admin header logo loaded');
                } else if (adminLogo && logos.main) {
                    // Fallback to main logo
                    adminLogo.src = logos.main;
                    adminLogo.style.display = 'inline-block';
                    console.log('✅ Admin header logo loaded (fallback)');
                }
            } catch (error) {
                console.error('❌ Error loading system logos:', error);
            }
        }

        // Handle logo updates
        function handleLogoUpdate(logos) {
            console.log('📷 Handling logo update:', logos);
            loadSystemLogos();
            showNotification('📷 Logo updated successfully', 'success');
        }

        // Listen for shared data changes including logo updates
        window.addEventListener('sharedDataChange', function(event) {
            const { type, data } = event.detail;
            if (type === 'logos_updated' || type === 'system_config_updated') {
                handleLogoUpdate(data);
            }
        });

        // Update system logo function
        function updateSystemLogo(logoUrl) {
            try {
                console.log('📷 Updating system logo to:', logoUrl);

                const updatedLogos = window.sharedDataManager.updateLogos({
                    main: logoUrl,
                    adminHeader: logoUrl,
                    partnerHeader: logoUrl
                });

                console.log('✅ System logo updated:', updatedLogos);
                showNotification('📷 Logo updated and synced to all portals!', 'success');

                // Immediately refresh logos
                loadSystemLogos();

                return updatedLogos;
            } catch (error) {
                console.error('❌ Error updating system logo:', error);
                showNotification('❌ Failed to update logo', 'error');
                throw error;
            }
        }

        function initializeAdminDashboard() {
            console.log('🔧 Initializing Faded Skies Admin Dashboard...');

            // Load system logos first
            loadSystemLogos();

            // Load products from shared data manager
            const sharedProducts = window.sharedDataManager.getProducts();
            if (sharedProducts.length > 0) {
                products = sharedProducts;
                console.log('📦 Loaded', products.length, 'products from shared data manager');
            } else {
                // Force sync default products to shared data manager
                console.log('📦 No shared products found, syncing defaults...');
                window.sharedDataManager.updateProducts(products);
            }

            // Load orders from shared data manager
            const sharedOrders = window.sharedDataManager.getOrders();
            if (sharedOrders.length > 0) {
                orders = sharedOrders;
                console.log('📦 Loaded', orders.length, 'orders from shared data manager');
            }

            // Listen for shared data changes
            window.addEventListener('sharedDataChange', handleAdminSharedDataChange);

            // Listen for real-time updates
            window.addEventListener('realTimeUpdate', handleAdminRealTimeUpdate);

            // Start portal sync monitoring
            startPortalSync();

            // Show login screen
            showLoginScreen();

            console.log('✅ Admin dashboard initialized');
            console.log('🔐 Secure admin portal ready');
            console.log('🔄 Portal sync monitoring active');
        }

        // Handle real-time updates
        function handleAdminRealTimeUpdate(event) {
            const { type, data, timestamp } = event.detail;
            console.log('📡 Admin received real-time update:', type, data);

            switch (type) {
                case 'new_order':
                    console.log('📦 NEW ORDER RECEIVED!', data);

                    // Add to orders array
                    orders.push(data);

                    // Update order display
                    updateOrdersDisplay();
                    updateOrdersTable();
                    updateOrderStatusDistribution();

                    // Show urgent notification
                    showNotification(`🚨 NEW ORDER: ${data.id} from ${data.partnerName} - $${data.total}`, 'success');

                    // Play notification sound (if browser supports it)
                    try {
                        const audio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBjiR1/LNeSsFJHfH8N2WUAfAl2Y');
                        audio.play().catch(() => {});
                    } catch (error) {
                        console.log('Audio notification not supported');
                    }

                    // Blink title if not in focus
                    if (document.hidden) {
                        let originalTitle = document.title;
                        let blinkCount = 0;
                        const blinkInterval = setInterval(() => {
                            document.title = blinkCount % 2 === 0 ? '🚨 NEW ORDER!' : originalTitle;
                            blinkCount++;
                            if (blinkCount > 6) {
                                clearInterval(blinkInterval);
                                document.title = originalTitle;
                            }
                        }, 500);
                    }
                    break;
                case 'cart_updated':
                    if (data.userEmail) {
                        console.log(`📦 Cart updated for user: ${data.userEmail}`);
                        // Could update user activity indicators here
                    }
                    break;
                case 'product_updated':
                case 'product_added':
                case 'product_deleted':
                    console.log('📦 Product update received');
                    products = window.sharedDataManager.getProducts();
                    updateAllDashboardViews();
                    break;
            }
        }

        // Handle shared data changes from partner portal
        function handleAdminSharedDataChange(event) {
            const { type, data } = event.detail;
            console.log('📡 Admin received shared data change:', type, data);

            switch (type) {
                case 'external_update':
                    // Reload products if they were updated externally
                    products = window.sharedDataManager.getProducts();
                    updateAllDashboardViews();
                    updateSyncStatus('connected');
                    break;
                case 'cart_updated':
                    // Update UI to show active cart users
                    updateSyncStatus('connected');
                    break;
            }
        }

        // Portal Synchronization System
        function startPortalSync() {
            // Simulate real-time sync with public website/partner portal
            syncInterval = setInterval(() => {
                if (isConnectedToPortal && currentUser) {
                    updateSyncStatus('syncing');
                    
                    // Simulate receiving data updates from partner portal
                    simulatePortalUpdates();
                    
                    // Update all views
                    updateAllDashboardViews();
                    
                    setTimeout(() => {
                        updateSyncStatus('connected');
                        document.getElementById('lastSync').textContent = 'Just now';
                    }, 1500);
                }
            }, 45000); // Sync every 45 seconds
        }

        function updateSyncStatus(status) {
            const syncElement = document.getElementById('syncStatus');
            if (!syncElement) return;
            
            switch(status) {
                case 'connected':
                    syncElement.innerHTML = '<span>✅</span><span>Portal Synced</span>';
                    syncElement.style.borderColor = 'var(--brand-green)';
                    break;
                case 'syncing':
                    syncElement.innerHTML = '<span>🔄</span><span>Syncing...</span>';
                    syncElement.style.borderColor = 'var(--accent-orange)';
                    break;
                case 'error':
                    syncElement.innerHTML = '<span>❌</span><span>Sync Error</span>';
                    syncElement.style.borderColor = 'var(--accent-red)';
                    break;
            }
        }

        function simulatePortalUpdates() {
            // Simulate new orders coming from partner portal
            if (Math.random() < 0.1) { // 10% chance
                const newOrder = {
                    id: `ORD-${String(orders.length + 1).padStart(3, '0')}`,
                    partner: 'partner@store.com',
                    partnerName: 'Green Valley Dispensary',
                    items: 'Random Order from Portal',
                    total: Math.floor(Math.random() * 5000) + 500,
                    status: 'PENDING',
                    priority: 'NORMAL',
                    date: new Date().toISOString().split('T')[0],
                    createdAt: new Date().toISOString(),
                    trackingNumber: null,
                    carrier: null,
                    estimatedDelivery: null,
                    paymentStatus: 'Paid',
                    shippingAddress: '123 Cannabis St, Los Angeles, CA 90210',
                    orderNotes: 'Auto-generated order from portal sync',
                    statusHistory: [
                        { 
                            status: 'PENDING', 
                            timestamp: new Date().toISOString(), 
                            note: 'Order received from partner portal' 
                        }
                    ]
                };
                orders.unshift(newOrder);
                showNotification(`📋 New order received from portal: ${newOrder.id}`, 'success');
            }
            
            // Simulate order status changes
            if (Math.random() < 0.2) { // 20% chance
                const pendingOrders = orders.filter(o => o.status === 'PENDING');
                if (pendingOrders.length > 0) {
                    const randomOrder = pendingOrders[Math.floor(Math.random() * pendingOrders.length)];
                    randomOrder.status = 'PROCESSING';
                    randomOrder.statusHistory.push({
                        status: 'PROCESSING',
                        timestamp: new Date().toISOString(),
                        note: 'Auto-processed by system'
                    });
                }
            }
            
            // Simulate stock changes
            if (Math.random() < 0.3) { // 30% chance
                const randomProduct = products[Math.floor(Math.random() * products.length)];
                if (randomProduct.stock > 0) {
                    randomProduct.stock = Math.max(0, randomProduct.stock - Math.floor(Math.random() * 3));
                    if (randomProduct.stock === 0) {
                        randomProduct.status = 'SOLD OUT';
                    }
                    randomProduct.lastModified = new Date().toISOString();
                    randomProduct.modifiedBy = 'portal-sync';
                }
            }
        }

        function forceSyncPortals() {
            updateSyncStatus('syncing');
            
            setTimeout(() => {
                updateSyncStatus('connected');
                updateAllDashboardViews();
                showNotification('🔄 All portals force-synchronized successfully!', 'success');
            }, 2000);
        }

        function syncToPortal() {
            updateSyncStatus('syncing');

            // Actually sync products to shared data manager
            window.sharedDataManager.updateProducts(products);
            console.log('🔄 Synced', products.length, 'products to shared data manager');

            setTimeout(() => {
                updateSyncStatus('connected');
                showNotification('📊 Inventory synced to partner portal successfully!', 'success');

                // Update last sync timestamp
                document.getElementById('lastSync').textContent = 'Just now';
            }, 1500);
        }

        // Authentication Functions
        function adminLogin(event) {
            event.preventDefault();
            
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;
            
            if (!email || !password) {
                showNotification('All fields are required', 'error');
                return;
            }

            // Admin authentication
            if (email === 'admin@fadedskies.com' && password === 'admin123') {
                currentUser = { 
                    email, 
                    role: 'admin',
                    loginTime: new Date().toISOString()
                };
                
                showAdminDashboard();
                showNotification('🔧 Welcome to Admin Dashboard!', 'success');
            } else {
                showNotification('Invalid admin credentials', 'error');
            }
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                currentUser = null;
                showLoginScreen();
                showNotification('🔒 Logged out successfully', 'success');
            }
        }

        function showLoginScreen() {
            document.getElementById('loginScreen').style.display = 'block';
            document.getElementById('adminDashboard').classList.remove('active');
            document.getElementById('adminSession').style.display = 'none';
        }

        function showAdminDashboard() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('adminDashboard').classList.add('active');
            document.getElementById('adminSession').style.display = 'block';
            document.getElementById('adminWelcome').textContent = `Welcome, ${currentUser.email.split('@')[0]}`;
            
            // Load dashboard data
            updateAllDashboardViews();
        }

        // Data Update Functions
        function updateAllDashboardViews() {
            updateDashboardStats();
            updateInventoryTable();
            updateOrdersTable();
            updatePricingTable();
            updatePricingAnalytics();
            updatePartnersTable();
            updatePartnerStats();
            updateAnalyticsDashboard();
        }

        function updateDashboardStats() {
            const totalProducts = products.length;
            const availableProducts = products.filter(p => p.status === 'AVAILABLE').length;
            const totalValue = products.reduce((sum, p) => sum + (p.price * p.stock), 0);
            const totalOrders = orders.length;
            const pendingOrders = orders.filter(o => o.status === 'PENDING').length;
            const totalRevenue = orders.reduce((sum, o) => sum + o.total, 0);
            
            updateElement('totalProducts', totalProducts);
            updateElement('availableProducts', availableProducts);
            updateElement('totalValue', `$${totalValue.toLocaleString()}`);
            updateElement('totalOrders', totalOrders);
            updateElement('pendingOrders', pendingOrders);
            updateElement('totalRevenue', `$${totalRevenue.toLocaleString()}`);
            
            // Order stats
            updateElement('ordersPending', pendingOrders);
            updateElement('ordersProcessing', orders.filter(o => o.status === 'PROCESSING').length);
            updateElement('ordersShipped', orders.filter(o => o.status === 'SHIPPED').length);
            updateElement('avgOrderValue', `${Math.round(totalRevenue / totalOrders)}`);
        }

        function updateElement(id, value) {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = value;
            }
        }

        function updateInventoryTable() {
            const tbody = document.getElementById('inventoryBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            // Filter products based on current filter
            let filteredProducts = products;
            if (currentFilter !== 'all') {
                filteredProducts = products.filter(p => {
                    switch(currentFilter) {
                        case 'available': return p.status === 'AVAILABLE';
                        case 'coming': return p.status === 'COMING SOON';
                        case 'soldout': return p.status === 'SOLD OUT';
                        default: return true;
                    }
                });
            }
            
            filteredProducts.forEach(product => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        ${product.photo ? `<img src="${product.photo}" alt="Photo" style="width:48px;height:48px;object-fit:cover;border-radius:8px;">` : '<span style="color:var(--text-muted);font-size:12px;">No Image</span>'}
                    </td>
                    <td>FS-${String(product.id).padStart(3, '0')}</td>
                    <td><strong>${product.grade}</strong></td>
                    <td>
                        <strong>${product.strain}</strong><br>
                        <small>${product.thca > 0 ? product.thca + '% • ' : ''}${product.type}</small>
                    </td>
                    <td>
                        <input type="number" class="editable" value="${product.price}" 
                               onchange="updateProductPrice(${product.id}, this.value)"
                               style="width: 100px;">
                    </td>
                    <td>${product.thca > 0 ? product.thca + '%' : '-'}</td>
                    <td>
                        <select class="editable" onchange="updateProductStatus(${product.id}, this.value)">
                            <option value="AVAILABLE" ${product.status === 'AVAILABLE' ? 'selected' : ''}>Available</option>
                            <option value="COMING SOON" ${product.status === 'COMING SOON' ? 'selected' : ''}>Coming Soon</option>
                            <option value="SOLD OUT" ${product.status === 'SOLD OUT' ? 'selected' : ''}>Sold Out</option>
                        </select>
                    </td>
                    <td>
                        <input type="number" class="editable" value="${product.stock}" 
                               onchange="updateProductStock(${product.id}, this.value)"
                               style="width: 80px;">
                    </td>
                    <td>
                        <small style="color: var(--text-muted);">${formatDateTime(product.lastModified)}</small><br>
                        <small style="color: var(--text-muted);">by ${product.modifiedBy.split('@')[0]}</small>
                    </td>
                    <td>
                        <button class="btn btn-secondary btn-sm" onclick="editProduct(${product.id})">Edit</button>
                        <button class="btn btn-danger btn-sm" onclick="deleteProduct(${product.id})">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateOrdersDisplay() {
            // Update the orders section if it exists
            const ordersCount = orders.length;
            const pendingOrders = orders.filter(o => o.status === 'PENDING').length;

            // Update dashboard metrics
            const orderElements = document.querySelectorAll('[data-metric="orders"]');
            orderElements.forEach(el => el.textContent = ordersCount);

            const pendingElements = document.querySelectorAll('[data-metric="pending-orders"]');
            pendingElements.forEach(el => el.textContent = pendingOrders);

            // Update orders table
            updateOrdersTable();

            console.log('📊 Orders display updated:', { total: ordersCount, pending: pendingOrders });
        }

        function updateOrdersTable() {
            const tbody = document.getElementById('ordersBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            // Filter orders based on current filter
            let filteredOrders = orders;
            if (currentOrderFilter !== 'all') {
                filteredOrders = orders.filter(o => o.status.toLowerCase() === currentOrderFilter);
            }
            
            filteredOrders.forEach(order => {
                const row = document.createElement('tr');
                
                // Status badge color
                const statusColors = {
                    'PENDING': 'var(--accent-orange)',
                    'PROCESSING': 'var(--accent-blue)', 
                    'SHIPPED': 'var(--brand-green)',
                    'DELIVERED': 'var(--brand-green)',
                    'CANCELLED': 'var(--accent-red)'
                };
                
                // Payment status color
                const paymentColor = order.paymentStatus === 'Paid' ? 'var(--brand-green)' : 'var(--accent-red)';
                
                // Tracking display
                const trackingDisplay = order.trackingNumber ? 
                    `<strong style="color: var(--brand-green);">${order.trackingNumber}</strong><br>
                     <small style="color: var(--text-muted);">${order.carrier || 'Unknown Carrier'}</small>` :
                    '<span style="color: var(--text-muted);">No tracking</span>';
                
                row.innerHTML = `
                    <td>
                        <strong>${order.id}</strong><br>
                        <span style="
                            padding: 2px 6px; border-radius: 4px; font-size: 10px; 
                            background: ${order.priority === 'HIGH' ? 'var(--accent-red)' : 
                                        order.priority === 'NORMAL' ? 'var(--accent-blue)' : 'var(--text-muted)'};
                            color: white;">
                            ${order.priority}
                        </span>
                    </td>
                    <td>
                        <strong>${order.partnerName}</strong><br>
                        <small style="color: var(--text-muted);">${order.partner}</small>
                    </td>
                    <td>
                        <small>${order.items}</small>
                    </td>
                    <td><strong>${order.total.toFixed(2)}</strong></td>
                    <td>
                        <select class="editable" onchange="updateOrderStatus('${order.id}', this.value)" style="width: 120px;">
                            <option value="PENDING" ${order.status === 'PENDING' ? 'selected' : ''}>Pending</option>
                            <option value="PROCESSING" ${order.status === 'PROCESSING' ? 'selected' : ''}>Processing</option>
                            <option value="SHIPPED" ${order.status === 'SHIPPED' ? 'selected' : ''}>Shipped</option>
                            <option value="DELIVERED" ${order.status === 'DELIVERED' ? 'selected' : ''}>Delivered</option>
                            <option value="CANCELLED" ${order.status === 'CANCELLED' ? 'selected' : ''}>Cancelled</option>
                        </select>
                    </td>
                    <td>
                        ${trackingDisplay}
                        ${order.estimatedDelivery ? `<br><small style="color: var(--text-muted);">ETA: ${formatDate(order.estimatedDelivery)}</small>` : ''}
                    </td>
                    <td>
                        <span style="color: ${paymentColor}; font-weight: bold;">${order.paymentStatus}</span>
                    </td>
                    <td>
                        <small>${formatDate(order.date)}</small>
                    </td>
                    <td>
                        <button class="btn btn-secondary btn-sm" onclick="editOrder('${order.id}')">Edit</button>
                        <button class="btn btn-primary btn-sm" onclick="addTracking('${order.id}')">📦 Track</button>
                        <button class="btn btn-admin btn-sm" onclick="viewOrderDetails('${order.id}')">Details</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updatePricingTable() {
            const tbody = document.getElementById('pricingBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            products.forEach(product => {
                const costBasis = product.costBasis || Math.round(product.price * 0.7);
                const margin = product.costBasis ? Math.round(((product.price - product.costBasis) / product.costBasis) * 100) : 30;
                const marketPrice = Math.round(product.price * (0.95 + Math.random() * 0.1));
                const recommended = Math.round(marketPrice * 0.98);
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <strong>${product.strain}</strong><br>
                        <small>${product.grade}</small>
                    </td>
                    <td><strong>$${product.price}</strong></td>
                    <td>$${costBasis}</td>
                    <td style="color: ${margin >= 30 ? 'var(--brand-green)' : margin >= 20 ? 'var(--accent-orange)' : 'var(--accent-red)'};">
                        ${margin}%
                    </td>
                    <td>$${marketPrice}</td>
                    <td style="color: ${recommended > product.price ? 'var(--brand-green)' : 'var(--accent-red)'};">
                        $${recommended}
                    </td>
                    <td>
                        <small style="color: var(--text-muted);">${formatDateTime(product.lastModified)}</small>
                    </td>
                    <td>
                        <button class="btn btn-secondary btn-sm" onclick="updateProductPrice(${product.id}, ${recommended})">Apply</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updatePricingAnalytics() {
            // Calculate pricing analytics
            const margins = products.filter(p => p.costBasis).map(p => ((p.price - p.costBasis) / p.costBasis) * 100);
            const avgMargin = margins.length ? Math.round(margins.reduce((a, b) => a + b, 0) / margins.length) : 32;
            const highestMargin = margins.length ? Math.round(Math.max(...margins)) : 45;
            const lowestMargin = margins.length ? Math.round(Math.min(...margins)) : 18;
            
            updateElement('avgMargin', avgMargin + '%');
            updateElement('highestMargin', highestMargin + '%');
            updateElement('lowestMargin', lowestMargin + '%');
            
            // Price distribution
            const aGrade = products.filter(p => p.grade === 'A-GRADE');
            const bGrade = products.filter(p => p.grade === 'B-GRADE');
            const concentrates = products.filter(p => p.grade === 'ROSIN' || p.grade === 'VAPE');
            
            const aGradeAvg = aGrade.length ? Math.round(aGrade.reduce((sum, p) => sum + p.price, 0) / aGrade.length) : 847;
            const bGradeAvg = bGrade.length ? Math.round(bGrade.reduce((sum, p) => sum + p.price, 0) / bGrade.length) : 550;
            const concentratesAvg = concentrates.length ? Math.round(concentrates.reduce((sum, p) => sum + p.price, 0) / concentrates.length) : 23;
            
            updateElement('agradeAvg', '$' + aGradeAvg);
            updateElement('bgradeAvg', '$' + bGradeAvg);
            updateElement('concentratesAvg', '$' + concentratesAvg);
        }

        // Product Management Functions
        function updateProductPrice(productId, newPrice) {
            const product = products.find(p => p.id === productId);
            if (product) {
                const updates = {
                    price: parseFloat(newPrice),
                    lastModified: new Date().toISOString(),
                    modifiedBy: currentUser.email
                };

                // Update local array
                Object.assign(product, updates);

                // Update shared data manager (this will notify partner portals)
                window.sharedDataManager.updateProduct(productId, updates);

                updatePricingTable();
                updateDashboardStats();
                showNotification(`💰 Price updated for ${product.strain}`, 'success');
            }
        }

        function updateProductStatus(productId, newStatus) {
            const product = products.find(p => p.id === productId);
            if (product) {
                const updates = {
                    status: newStatus,
                    lastModified: new Date().toISOString(),
                    modifiedBy: currentUser.email
                };

                // Update local array
                Object.assign(product, updates);

                // Update shared data manager (this will notify partner portals)
                window.sharedDataManager.updateProduct(productId, updates);

                updateInventoryTable();
                updateDashboardStats();
                showNotification(`📊 Status updated for ${product.strain}`, 'success');
            }
        }

        function updateProductStock(productId, newStock) {
            const product = products.find(p => p.id === productId);
            if (product) {
                const updates = {
                    stock: parseInt(newStock),
                    lastModified: new Date().toISOString(),
                    modifiedBy: currentUser.email
                };

                // Auto-update status based on stock
                if (updates.stock === 0) {
                    updates.status = 'SOLD OUT';
                } else if (product.status === 'SOLD OUT' && updates.stock > 0) {
                    updates.status = 'AVAILABLE';
                }

                // Update local array
                Object.assign(product, updates);

                // Update shared data manager (this will notify partner portals)
                window.sharedDataManager.updateProduct(productId, updates);

                updateInventoryTable();
                updateDashboardStats();
                showNotification(`📦 Stock updated for ${product.strain}`, 'success');
            }
        }

        function deleteProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (product && confirm(`Are you sure you want to delete ${product.strain}?`)) {
                // Remove from local array
                products = products.filter(p => p.id !== productId);

                // Remove from shared data manager (this will notify partner portals)
                window.sharedDataManager.deleteProduct(productId);

                updateAllDashboardViews();
                showNotification(`���️ Product ${product.strain} deleted`, 'success');
            }
        }

        function editProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            // Fill the add product modal with existing data
            document.getElementById('newGrade').value = product.grade;
            document.getElementById('newStatus').value = product.status;
            document.getElementById('newStrain').value = product.strain;
            document.getElementById('newThca').value = product.thca;
            document.getElementById('newPrice').value = product.price;
            document.getElementById('newStock').value = product.stock;
            document.getElementById('newType').value = product.type;
            document.getElementById('newCostBasis').value = product.costBasis || '';
            document.getElementById('newDescription').value = product.description || '';
            // Photo preview
            const photoPreview = document.getElementById('photoPreview');
            if (product.photo) {
                photoPreview.innerHTML = `<img src="${product.photo}" alt="Photo" style="width:80px;height:80px;object-fit:cover;border-radius:8px;">`;
            } else {
                photoPreview.innerHTML = '';
            }
            document.getElementById('newPhoto').value = '';
            
            // Change modal title
            document.querySelector('#addProductModal .modal-title').textContent = 'Edit Product ✏️';
            
            // Store the product ID for editing
            window.editingProductId = productId;
            
            openModal('addProductModal');
        }

        function addProduct(event) {
            event.preventDefault();
            
            const productData = {
                grade: document.getElementById('newGrade').value,
                strain: document.getElementById('newStrain').value,
                thca: parseFloat(document.getElementById('newThca').value),
                price: parseFloat(document.getElementById('newPrice').value),
                status: document.getElementById('newStatus').value,
                stock: parseInt(document.getElementById('newStock').value) || 0,
                type: document.getElementById('newType').value,
                costBasis: parseFloat(document.getElementById('newCostBasis').value) || null,
                description: document.getElementById('newDescription').value || '',
                lastModified: new Date().toISOString(),
                modifiedBy: currentUser.email,
                photo: window._productPhotoData || ''
            };
            
            if (window.editingProductId) {
                // Edit existing product
                const product = products.find(p => p.id === window.editingProductId);
                Object.assign(product, productData);

                // Update shared data manager (this will notify partner portals)
                window.sharedDataManager.updateProduct(window.editingProductId, productData);

                showNotification(`✅ Product ${product.strain} updated successfully!`, 'success');
                delete window.editingProductId;
            } else {
                // Add new product
                productData.id = nextProductId++;
                products.push(productData);

                // Add to shared data manager (this will notify partner portals)
                window.sharedDataManager.addProduct(productData);

                showNotification(`✅ Product ${productData.strain} added successfully!`, 'success');
            }

            updateAllDashboardViews();
            closeModal('addProductModal');
            
            // Reset form
            event.target.reset();
            document.querySelector('#addProductModal .modal-title').textContent = 'Add New Product 🌿';
            window._productPhotoData = '';
            document.getElementById('photoPreview').innerHTML = '';
        }

        // Order Management Functions
        function updateOrderStatus(orderId, newStatus) {
            const order = orders.find(o => o.id === orderId);
            if (order) {
                order.status = newStatus;
                
                // Add to status history
                order.statusHistory.push({
                    status: newStatus,
                    timestamp: new Date().toISOString(),
                    note: `Status updated to ${newStatus} by admin`
                });
                
                updateOrdersTable();
                updateDashboardStats();
                showNotification(`📋 Order ${orderId} status updated to ${newStatus}`, 'success');
                
                // Send notification email if shipped or delivered
                if (newStatus === 'SHIPPED' || newStatus === 'DELIVERED') {
                    sendOrderStatusEmail(order, newStatus);
                }
            }
        }

        function addTracking(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) {
                showNotification('Order not found', 'error');
                return;
            }
            
            // Populate order details in modal
            document.getElementById('trackingOrderId').value = orderId;
            document.getElementById('trackingOrderDetails').innerHTML = `
                <strong>Order ${order.id}</strong> - ${order.partnerName}<br>
                <small>Items: ${order.items}</small><br>
                <small>Total: ${order.total.toFixed(2)} • Status: ${order.status}</small>
            `;
            
            // Pre-fill existing tracking info if available
            document.getElementById('trackingNumber').value = order.trackingNumber || '';
            document.getElementById('trackingCarrier').value = order.carrier || '';
            document.getElementById('estimatedDelivery').value = order.estimatedDelivery || '';
            document.getElementById('trackingUrl').value = order.trackingUrl || '';
            document.getElementById('shippingNotes').value = order.shippingNotes || '';
            
            openModal('addTrackingModal');
        }

        function saveTrackingInfo(event) {
            event.preventDefault();
            
            const orderId = document.getElementById('trackingOrderId').value;
            const order = orders.find(o => o.id === orderId);
            
            if (!order) {
                showNotification('Order not found', 'error');
                return;
            }
            
            // Update order with tracking information
            order.trackingNumber = document.getElementById('trackingNumber').value;
            order.carrier = document.getElementById('trackingCarrier').value;
            order.estimatedDelivery = document.getElementById('estimatedDelivery').value || null;
            order.trackingUrl = document.getElementById('trackingUrl').value || null;
            order.shippingNotes = document.getElementById('shippingNotes').value || null;
            
            // Update status if requested
            const newStatus = document.getElementById('newTrackingStatus').value;
            if (newStatus !== order.status) {
                order.status = newStatus;
                order.statusHistory.push({
                    status: newStatus,
                    timestamp: new Date().toISOString(),
                    note: `Status updated to ${newStatus} with tracking info`
                });
            }
            
            // Add tracking to status history
            order.statusHistory.push({
                status: order.status,
                timestamp: new Date().toISOString(),
                note: `Tracking added: ${order.trackingNumber} via ${order.carrier}`
            });
            
            // Send notification email if requested
            const notifyCustomer = document.getElementById('notifyCustomer').checked;
            if (notifyCustomer) {
                sendTrackingNotificationEmail(order);
            }
            
            updateOrdersTable();
            closeModal('addTrackingModal');
            showNotification(`📦 Tracking information saved for order ${orderId}`, 'success');
            
            // Reset form
            event.target.reset();
        }

        function viewOrderDetails(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) {
                showNotification('Order not found', 'error');
                return;
            }
            
            const trackingSection = order.trackingNumber ? `
                <div class="card" style="margin-bottom: 20px;">
                    <h3>���� Tracking Information</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                        <div>
                            <strong>Tracking Number:</strong><br>
                            <code style="font-size: 14px; background: var(--surface-elevated); padding: 4px 8px; border-radius: 4px;">${order.trackingNumber}</code>
                        </div>
                        <div>
                            <strong>Carrier:</strong><br>
                            ${order.carrier}
                        </div>
                        <div>
                            <strong>Estimated Delivery:</strong><br>
                            ${order.estimatedDelivery ? formatDate(order.estimatedDelivery) : 'Not set'}
                        </div>
                        <div>
                            <strong>Current Status:</strong><br>
                            <span style="color: var(--brand-green); font-weight: bold;">${order.status}</span>
                        </div>
                    </div>
                    ${order.trackingUrl ? `
                        <div style="margin-top: 12px;">
                            <a href="${order.trackingUrl}" target="_blank" class="btn btn-secondary btn-sm">🔗 Track Package</a>
                        </div>
                    ` : ''}
                    ${order.shippingNotes ? `
                        <div style="margin-top: 12px;">
                            <strong>Shipping Notes:</strong><br>
                            <small style="color: var(--text-muted);">${order.shippingNotes}</small>
                        </div>
                    ` : ''}
                </div>
            ` : `
                <div class="card" style="margin-bottom: 20px; border: 1px solid var(--accent-orange);">
                    <h3 style="color: var(--accent-orange);">⚠️ No Tracking Information</h3>
                    <p style="color: var(--text-muted);">This order has not been assigned tracking information yet.</p>
                    <button class="btn btn-primary btn-sm" onclick="closeModal('orderDetailsModal'); addTracking('${order.id}')">📦 Add Tracking</button>
                </div>
            `;
            
            document.getElementById('orderDetailsContent').innerHTML = `
                <div class="grid">
                    <div class="card">
                        <h3>📋 Order Information</h3>
                        <div style="margin-bottom: 12px;">
                            <strong>Order ID:</strong> ${order.id}<br>
                            <strong>Date:</strong> ${formatDateTime(order.createdAt)}<br>
                            <strong>Priority:</strong> <span style="color: ${order.priority === 'HIGH' ? 'var(--accent-red)' : 'var(--accent-blue)'};">${order.priority}</span><br>
                            <strong>Total:</strong> ${order.total.toFixed(2)}
                        </div>
                        <div style="margin-bottom: 12px;">
                            <strong>Items:</strong><br>
                            <small style="color: var(--text-muted);">${order.items}</small>
                        </div>
                        ${order.orderNotes ? `
                            <div>
                                <strong>Order Notes:</strong><br>
                                <small style="color: var(--text-muted);">${order.orderNotes}</small>
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="card">
                        <h3>👥 Partner Information</h3>
                        <div style="margin-bottom: 12px;">
                            <strong>Business:</strong> ${order.partnerName}<br>
                            <strong>Email:</strong> ${order.partner}<br>
                            <strong>Payment Status:</strong> <span style="color: var(--brand-green);">${order.paymentStatus}</span>
                        </div>
                        <div>
                            <strong>Shipping Address:</strong><br>
                            <small style="color: var(--text-muted);">${order.shippingAddress}</small>
                        </div>
                    </div>
                </div>
                
                ${trackingSection}
                
                <div class="card">
                    <h3>📈 Status History</h3>
                    <div style="font-family: monospace; font-size: 12px; line-height: 1.8;">
                        ${order.statusHistory.map(status => `
                            <div style="margin-bottom: 8px; padding: 8px; background: var(--surface-elevated); border-radius: 4px;">
                                <strong style="color: var(--brand-green);">${status.status}</strong> - ${formatDateTime(status.timestamp)}<br>
                                <small style="color: var(--text-muted);">${status.note}</small>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div style="display: flex; gap: 12px; margin-top: 20px;">
                    <button class="btn btn-secondary" onclick="editOrder('${order.id}'); closeModal('orderDetailsModal');">✏️ Edit Order</button>
                    ${!order.trackingNumber ? `<button class="btn btn-primary" onclick="addTracking('${order.id}'); closeModal('orderDetailsModal');">📦 Add Tracking</button>` : ''}
                    <button class="btn btn-admin" onclick="generateShippingLabel('${order.id}')">📄 Shipping Label</button>
                </div>
            `;
            
            openModal('orderDetailsModal');
        }

        function sendTrackingNotificationEmail(order) {
            const trackingMessage = `
Dear ${order.partnerName},

Your order has been shipped! 📦

ORDER DETAILS:
• Order ID: ${order.id}
• Items: ${order.items}
• Total: ${order.total.toFixed(2)}

TRACKING INFORMATION:
• Tracking Number: ${order.trackingNumber}
• Carrier: ${order.carrier}
• Estimated Delivery: ${order.estimatedDelivery ? formatDate(order.estimatedDelivery) : 'TBD'}

${order.trackingUrl ? `Track your package: ${order.trackingUrl}` : ''}

${order.shippingNotes ? `Shipping Notes: ${order.shippingNotes}` : ''}

You can also track your order through your partner portal:
🌐 https://portal.fadedskies.com

Thank you for your business!

Best regards,
Faded Skies Wholesale Team
            `;
            
            console.log('📧 Tracking notification sent to:', order.partner);
            console.log(trackingMessage);
            showNotification(`📧 Tracking notification sent to ${order.partnerName}`, 'success');
        }

        function sendOrderStatusEmail(order, status) {
            const statusMessages = {
                'SHIPPED': `Your order ${order.id} has been shipped! Tracking information: ${order.trackingNumber || 'Will be provided shortly'}`,
                'DELIVERED': `Your order ${order.id} has been delivered successfully! Thank you for your business.`
            };
            
            console.log(`📧 ${status} notification sent to:`, order.partner);
            console.log(statusMessages[status]);
            showNotification(`📧 ${status} notification sent to ${order.partnerName}`, 'success');
        }

        function lookupCustomerOrder() {
            const lookupValue = document.getElementById('customerLookupInput').value.trim();
            if (!lookupValue) {
                showNotification('Please enter an Order ID or Tracking Number', 'error');
                return;
            }
            
            // Find order by ID or tracking number
            const order = orders.find(o => 
                o.id.toLowerCase() === lookupValue.toLowerCase() || 
                (o.trackingNumber && o.trackingNumber.toLowerCase() === lookupValue.toLowerCase())
            );
            
            const resultsDiv = document.getElementById('customerTrackingResults');
            
            if (!order) {
                resultsDiv.innerHTML = `
                    <div style="background: var(--surface-elevated); padding: 20px; border-radius: 8px; text-align: center; border: 1px solid var(--accent-red);">
                        <h4 style="color: var(--accent-red);">❌ Order Not Found</h4>
                        <p style="color: var(--text-muted);">No order found with ID or tracking number: ${lookupValue}</p>
                    </div>
                `;
                return;
            }
            
            // Display customer tracking view
            resultsDiv.innerHTML = `
                <div style="background: var(--surface-card); padding: 20px; border-radius: 8px; border: 1px solid var(--brand-green);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h4 style="color: var(--brand-green);">📦 Order ${order.id}</h4>
                        <span style="padding: 4px 12px; background: var(--brand-green); color: white; border-radius: 12px; font-size: 12px; font-weight: bold;">${order.status}</span>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div>
                            <strong>Order Date:</strong><br>
                            <small style="color: var(--text-muted);">${formatDate(order.date)}</small>
                        </div>
                        <div>
                            <strong>Total:</strong><br>
                            <strong style="color: var(--brand-green);">${order.total.toFixed(2)}</strong>
                        </div>
                        ${order.trackingNumber ? `
                            <div>
                                <strong>Tracking Number:</strong><br>
                                <code style="background: var(--surface-elevated); padding: 2px 6px; border-radius: 4px;">${order.trackingNumber}</code>
                            </div>
                            <div>
                                <strong>Carrier:</strong><br>
                                <small style="color: var(--text-muted);">${order.carrier}</small>
                            </div>
                        ` : ''}
                        ${order.estimatedDelivery ? `
                            <div>
                                <strong>Estimated Delivery:</strong><br>
                                <small style="color: var(--text-muted);">${formatDate(order.estimatedDelivery)}</small>
                            </div>
                        ` : ''}
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <strong>Items:</strong><br>
                        <small style="color: var(--text-muted);">${order.items}</small>
                    </div>
                    
                    ${order.trackingUrl ? `
                        <div style="margin-bottom: 20px;">
                            <a href="${order.trackingUrl}" target="_blank" class="btn btn-primary btn-sm">🔗 Track with ${order.carrier}</a>
                        </div>
                    ` : ''}
                    
                    <div>
                        <h5 style="color: var(--brand-green); margin-bottom: 12px;">📈 Order Progress</h5>
                        <div style="font-family: monospace; font-size: 12px; line-height: 1.6;">
                            ${order.statusHistory.map((status, index) => `
                                <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                    <span style="width: 12px; height: 12px; background: ${index === order.statusHistory.length - 1 ? 'var(--brand-green)' : 'var(--text-muted)'}; border-radius: 50%; margin-right: 12px;"></span>
                                    <div>
                                        <strong>${status.status}</strong> - ${formatDateTime(status.timestamp)}<br>
                                        <small style="color: var(--text-muted);">${status.note}</small>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function generateShippingLabel(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) {
                showNotification('Order not found', 'error');
                return;
            }
            
            // Simulate shipping label generation
            const labelWindow = window.open('', '_blank', 'width=600,height=800');
            labelWindow.document.write(`
                <html>
                <head><title>Shipping Label - ${order.id}</title></head>
                <body style="font-family: Arial, sans-serif; padding: 20px;">
                    <div style="border: 2px solid #000; padding: 20px; max-width: 600px;">
                        <h2>🌿 FADED SKIES WHOLESALE</h2>
                        <hr>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <h3>FROM:</h3>
                                <p>Faded Skies Wholesale<br>
                                123 Cannabis Ave<br>
                                Helotes, TX 78023<br>
                                (210) 835-7834</p>
                            </div>
                            <div>
                                <h3>TO:</h3>
                                <p><strong>${order.partnerName}</strong><br>
                                ${order.shippingAddress}</p>
                            </div>
                        </div>
                        <hr>
                        <div style="text-align: center; margin: 20px 0;">
                            <h3>ORDER: ${order.id}</h3>
                            <h3>TRACKING: ${order.trackingNumber || 'N/A'}</h3>
                            <h3>CARRIER: ${order.carrier || 'N/A'}</h3>
                        </div>
                        <hr>
                        <div>
                            <h4>CONTENTS:</h4>
                            <p>${order.items}</p>
                            <p><strong>Total: ${order.total.toFixed(2)}</strong></p>
                        </div>
                    </div>
                    <div style="margin-top: 20px; text-align: center;">
                        <button onclick="window.print()" style="padding: 10px 20px; background: #00C851; color: white; border: none; border-radius: 4px; cursor: pointer;">🖨️ Print Label</button>
                    </div>
                </body>
                </html>
            `);
            
            showNotification(`📄 Shipping label generated for order ${orderId}`, 'success');
        }

        function createOrder(event) {
            event.preventDefault();
            
            const orderData = {
                id: `ORD-${String(orders.length + 1).padStart(3, '0')}`,
                partner: document.getElementById('orderPartnerEmail').value,
                partnerName: document.getElementById('orderPartnerName').value,
                items: document.getElementById('orderItems').value,
                total: parseFloat(document.getElementById('orderTotal').value),
                status: 'PENDING',
                priority: document.getElementById('orderPriority').value,
                date: new Date().toISOString().split('T')[0],
                createdAt: new Date().toISOString(),
                trackingNumber: null,
                carrier: null,
                estimatedDelivery: null,
                paymentStatus: 'Paid', // Immediate payment required
                shippingAddress: 'Address to be confirmed',
                orderNotes: 'New order created via admin panel',
                statusHistory: [
                    { 
                        status: 'PENDING', 
                        timestamp: new Date().toISOString(), 
                        note: 'Order created by admin' 
                    }
                ]
            };
            
            orders.unshift(orderData);
            updateAllDashboardViews();
            closeModal('createOrderModal');
            showNotification(`✅ Order ${orderData.id} created successfully!`, 'success');
            
            // Reset form
            event.target.reset();
        }

        function editOrder(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) {
                showNotification('Order not found', 'error');
                return;
            }
            
            // Parse items into editable fields
            const itemsArr = order.items.split(', ').map(itemStr => {
                const match = itemStr.match(/^(.+?) \(x(\d+)\)$/);
                return match ? { name: match[1], quantity: parseInt(match[2]) } : { name: itemStr, quantity: 1 };
            });
            
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 600px;">
                    <div class="modal-header">
                        <h3 class="modal-title">��️ Edit Order - ${order.id}</h3>
                        <button class="modal-close" onclick="this.closest('.modal').remove(); document.body.style.overflow = 'auto';">×</button>
                    </div>
                    <form id="editOrderForm">
                        <div class="form-group">
                            <label>Order Items</label>
                            <div id="editOrderItems">
                                ${itemsArr.map((item, idx) => `
                                    <div style='display:flex; gap:8px; margin-bottom:8px;'>
                                        <input type='text' value='${item.name}' data-idx='${idx}' class='edit-item-name' style='flex:2;' required />
                                        <input type='number' value='${item.quantity}' min='1' data-idx='${idx}' class='edit-item-qty' style='width:60px;' required />
                                        <button type='button' onclick='this.parentElement.remove()' style='color:red;background:none;border:none;font-size:18px;'>&times;</button>
                                    </div>
                                `).join('')}
                            </div>
                            <button type='button' id='addOrderItemBtn' class='btn btn-secondary btn-sm' style='margin-top:8px;'>+ Add Item</button>
                        </div>
                        <div class="form-group">
                            <label for="editOrderNotes">Special Instructions</label>
                            <textarea id="editOrderNotes" rows="3">${order.notes || ''}</textarea>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width:100%;">Save Changes</button>
                    </form>
                </div>
            `;
            document.body.appendChild(modal);
            document.body.style.overflow = 'hidden';
            
            // Add item logic
            modal.querySelector('#addOrderItemBtn').onclick = function() {
                const container = modal.querySelector('#editOrderItems');
                const idx = container.children.length;
                const div = document.createElement('div');
                div.style.display = 'flex';
                div.style.gap = '8px';
                div.style.marginBottom = '8px';
                div.innerHTML = `
                    <input type='text' class='edit-item-name' data-idx='${idx}' style='flex:2;' required />
                    <input type='number' class='edit-item-qty' data-idx='${idx}' min='1' value='1' style='width:60px;' required />
                    <button type='button' onclick='this.parentElement.remove()' style='color:red;background:none;border:none;font-size:18px;'>&times;</button>
                `;
                container.appendChild(div);
            };
            
            // Handle form submit
            modal.querySelector('#editOrderForm').onsubmit = function(e) {
                e.preventDefault();
                // Collect items
                const itemNames = Array.from(modal.querySelectorAll('.edit-item-name')).map(i => i.value.trim());
                const itemQtys = Array.from(modal.querySelectorAll('.edit-item-qty')).map(i => parseInt(i.value));
                const itemsStr = itemNames.map((name, i) => `${name} (x${itemQtys[i]})`).join(', ');
                
                order.items = itemsStr;
                order.notes = modal.querySelector('#editOrderNotes').value.trim();
                updateOrdersTable();
                showNotification('✅ Order updated successfully!', 'success');
                modal.remove();
                document.body.style.overflow = 'auto';
            };
        }

        function processOrder(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (order) {
                if (order.status === 'PENDING') {
                    order.status = 'PROCESSING';
                } else if (order.status === 'PROCESSING') {
                    order.status = 'SHIPPED';
                }
                updateOrdersTable();
                showNotification(`📦 Order ${orderId} moved to ${order.status}`, 'success');
            }
        }

        // Filtering Functions
        function filterProducts(searchTerm) {
            const rows = document.querySelectorAll('#inventoryTable tbody tr');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                const matches = text.includes(searchTerm.toLowerCase());
                row.style.display = matches ? '' : 'none';
            });
        }

        function filterByStatus(status) {
            currentFilter = status;
            
            // Update filter button states
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            updateInventoryTable();
        }

        function filterOrders(searchTerm) {
            const rows = document.querySelectorAll('#ordersTable tbody tr');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                const matches = text.includes(searchTerm.toLowerCase());
                row.style.display = matches ? '' : 'none';
            });
        }

        function filterOrdersByStatus(status) {
            currentOrderFilter = status;
            
            // Update filter button states
            document.querySelectorAll('#orders .filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            updateOrdersTable();
        }

        // Bulk Operations
        function processBulkPriceUpdate(event) {
            event.preventDefault();
            
            const updateType = document.getElementById('updateType').value;
            const applyTo = document.getElementById('applyTo').value;
            
            let affectedProducts = products;
            
            // Filter products based on selection
            if (applyTo === 'available') {
                affectedProducts = products.filter(p => p.status === 'AVAILABLE');
            } else if (applyTo === 'category') {
                const category = document.getElementById('categorySelect').value;
                affectedProducts = products.filter(p => p.grade === category);
            } else if (applyTo === 'below-margin') {
                affectedProducts = products.filter(p => {
                    if (!p.costBasis) return false;
                    const margin = ((p.price - p.costBasis) / p.costBasis) * 100;
                    return margin < 30;
                });
            }
            
            // Apply price updates
            affectedProducts.forEach(product => {
                if (updateType === 'percentage') {
                    const change = parseFloat(document.getElementById('percentageChange').value);
                    product.price = Math.round(product.price * (1 + change / 100));
                } else if (updateType === 'fixed') {
                    const change = parseFloat(document.getElementById('fixedChange').value);
                    product.price = Math.max(1, product.price + change);
                } else if (updateType === 'margin') {
                    const targetMargin = parseFloat(document.getElementById('targetMargin').value);
                    if (product.costBasis) {
                        product.price = Math.round(product.costBasis * (1 + targetMargin / 100));
                    }
                }
                
                product.lastModified = new Date().toISOString();
                product.modifiedBy = currentUser.email;
            });
            
            updateAllDashboardViews();
            closeModal('bulkPriceModal');
            showNotification(`💰 Bulk price update applied to ${affectedProducts.length} products!`, 'success');
            syncToPortal();
        }

        function toggleUpdateFields() {
            const updateType = document.getElementById('updateType').value;
            const applyTo = document.getElementById('applyTo').value;
            
            document.getElementById('percentageField').style.display = updateType === 'percentage' ? 'block' : 'none';
            document.getElementById('fixedField').style.display = updateType === 'fixed' ? 'block' : 'none';
            document.getElementById('marginField').style.display = updateType === 'margin' ? 'block' : 'none';
            document.getElementById('categoryField').style.display = applyTo === 'category' ? 'block' : 'none';
        }

        function processBulkImport() {
            const csvData = document.getElementById('csvData').value.trim();
            if (!csvData) {
                showNotification('Please paste CSV data or upload a file', 'error');
                return;
            }
            
            const lines = csvData.split('\n');
            const headers = lines[0].split(',').map(h => h.trim().toLowerCase());
            let imported = 0;
            
            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',').map(v => v.trim());
                if (values.length < headers.length) continue;
                
                const productData = {
                    id: nextProductId++,
                    grade: values[headers.indexOf('grade')] || 'A-GRADE',
                    strain: values[headers.indexOf('strain')] || 'Unknown Strain',
                    thca: parseFloat(values[headers.indexOf('thca')]) || 0,
                    price: parseFloat(values[headers.indexOf('price')]) || 0,
                    status: values[headers.indexOf('status')] || 'AVAILABLE',
                    stock: parseInt(values[headers.indexOf('stock')]) || 0,
                    type: values[headers.indexOf('type')] || 'Hybrid',
                    costBasis: parseFloat(values[headers.indexOf('costbasis')]) || null,
                    lastModified: new Date().toISOString(),
                    modifiedBy: currentUser.email
                };
                
                products.push(productData);
                imported++;
            }
            
            updateAllDashboardViews();
            closeModal('bulkImportModal');
            showNotification(`📦 Successfully imported ${imported} products!`, 'success');
            syncToPortal();
        }

        function handleFileUpload(input) {
            const file = input.files[0];
            if (file && file.type === 'text/csv') {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('csvData').value = e.target.result;
                };
                reader.readAsText(file);
            }
        }

        // Export Functions
        function exportInventory() {
            const csvContent = 'data:text/csv;charset=utf-8,' + 
                'ID,Grade,Strain,THCA,Price,Status,Stock,Type,Last Modified\n' +
                products.map(p => 
                    `FS-${String(p.id).padStart(3, '0')},${p.grade},"${p.strain}",${p.thca},${p.price},${p.status},${p.stock},${p.type},${p.lastModified}`
                ).join('\n');
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement('a');
            link.setAttribute('href', encodedUri);
            link.setAttribute('download', 'faded_skies_inventory.csv');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('📄 Inventory exported successfully!', 'success');
        }

        function exportOrders() {
            const csvContent = 'data:text/csv;charset=utf-8,' + 
                'Order ID,Partner,Partner Name,Items,Total,Status,Priority,Date,Payment Status,Tracking Number,Carrier,Estimated Delivery,Shipping Address\n' +
                orders.map(o => 
                    `${o.id},${o.partner},"${o.partnerName}","${o.items}",${o.total},${o.status},${o.priority},${o.date},${o.paymentStatus || 'Paid'},${o.trackingNumber || ''},${o.carrier || ''},${o.estimatedDelivery || ''},"${o.shippingAddress || ''}"`
                ).join('\n');
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement('a');
            link.setAttribute('href', encodedUri);
            link.setAttribute('download', 'faded_skies_orders_with_tracking.csv');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('📄 Orders with tracking data exported successfully!', 'success');
        }

        function exportPricing() {
            const csvContent = 'data:text/csv;charset=utf-8,' + 
                'Product,Grade,Current Price,Cost Basis,Margin %,Last Updated\n' +
                products.map(p => {
                    const margin = p.costBasis ? Math.round(((p.price - p.costBasis) / p.costBasis) * 100) : 0;
                    return `"${p.strain}",${p.grade},${p.price},${p.costBasis || 0},${margin}%,${p.lastModified}`;
                }).join('\n');
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement('a');
            link.setAttribute('href', encodedUri);
            link.setAttribute('download', 'faded_skies_pricing.csv');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('📄 Pricing data exported successfully!', 'success');
        }

        function exportPartners() {
            const csvContent = 'data:text/csv;charset=utf-8,' + 
                'ID,Business Name,Contact Name,Email,Phone,Business Type,Tier,Status,Total Orders,Total Revenue,Credit Limit,Payment Terms,Join Date,Last Login\n' +
                partners.map(p => 
                    `${p.id},"${p.businessName}","${p.contactName}",${p.email},${p.phone},${p.businessType},${p.tier},${p.status},${p.totalOrders},${p.totalRevenue},${p.creditLimit},${p.paymentTerms},${p.joinDate},${p.lastLogin || 'Never'}`
                ).join('\n');
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement('a');
            link.setAttribute('href', encodedUri);
            link.setAttribute('download', 'faded_skies_partners.csv');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('📄 Partners exported successfully!', 'success');
        }

        function exportAnalytics() {
            showNotification('📈 Analytics export functionality coming soon!', 'warning');
        }

        function exportLogs() {
            showNotification('📋 System logs export functionality coming soon!', 'warning');
        }

        // Analytics Functions
        function updateAnalyticsDashboard() {
            // Calculate analytics metrics
            const totalRevenue = orders.reduce((sum, o) => sum + o.total, 0);
            const totalOrders = orders.length;
            const avgOrderValue = totalOrders > 0 ? totalRevenue / totalOrders : 0;
            
            // Calculate growth rate (simulated vs last period)
            const currentPeriodOrders = orders.filter(o => {
                const orderDate = new Date(o.date);
                const thirtyDaysAgo = new Date();
                thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
                return orderDate > thirtyDaysAgo;
            });
            const currentPeriodRevenue = currentPeriodOrders.reduce((sum, o) => sum + o.total, 0);
            const growthRate = Math.round(((currentPeriodRevenue / totalRevenue) * 100) - 100) + 23; // Base growth
            
            // Calculate fulfillment metrics
            const ordersWithTracking = orders.filter(o => o.trackingNumber).length;
            const fulfillmentRate = totalOrders > 0 ? Math.round((ordersWithTracking / totalOrders) * 100) : 0;
            
            // Calculate average delivery time
            const deliveredOrders = orders.filter(o => o.status === 'DELIVERED');
            let avgDeliveryTime = 0;
            if (deliveredOrders.length > 0) {
                const deliveryTimes = deliveredOrders.map(order => {
                    const createdDate = new Date(order.createdAt);
                    const deliveredStatus = order.statusHistory.find(s => s.status === 'DELIVERED');
                    if (deliveredStatus) {
                        const deliveredDate = new Date(deliveredStatus.timestamp);
                        return Math.ceil((deliveredDate - createdDate) / (1000 * 60 * 60 * 24));
                    }
                    return 3; // Default delivery time
                });
                avgDeliveryTime = Math.round(deliveryTimes.reduce((sum, time) => sum + time, 0) / deliveryTimes.length);
            }
            
            // Update analytics stats
            updateElement('analyticsRevenue', `${totalRevenue.toLocaleString()}`);
            updateElement('analyticsOrders', totalOrders);
            updateElement('analyticsAvgOrder', `${Math.round(avgOrderValue)}`);
            updateElement('analyticsGrowthRate', `${growthRate}%`);
            updateElement('analyticsFulfillmentRate', `${fulfillmentRate}%`);
            updateElement('analyticsAvgDeliveryTime', avgDeliveryTime || 3);
            
            // Update fulfillment performance
            updateFulfillmentMetrics();
            updateTopProductsAnalytics();
            updatePartnerPerformanceAnalytics();
            updateOrderStatusDistribution();
            updateWeeklyOrderVolume();
        }

        function updateFulfillmentMetrics() {
            const totalOrders = orders.length;
            const ordersWithTracking = orders.filter(o => o.trackingNumber).length;
            const trackingPercentage = totalOrders > 0 ? Math.round((ordersWithTracking / totalOrders) * 100) : 0;
            
            // Calculate same-day processing
            const sameDayProcessed = orders.filter(order => {
                const createdDate = new Date(order.createdAt);
                const processingStatus = order.statusHistory.find(s => s.status === 'PROCESSING');
                if (processingStatus) {
                    const processedDate = new Date(processingStatus.timestamp);
                    const daysDiff = Math.ceil((processedDate - createdDate) / (1000 * 60 * 60 * 24));
                    return daysDiff <= 1;
                }
                return false;
            }).length;
            const sameDayRate = totalOrders > 0 ? Math.round((sameDayProcessed / totalOrders) * 100) : 0;
            
            // Calculate on-time delivery (simulated based on estimated vs actual)
            const onTimeRate = 88 + Math.floor(Math.random() * 10); // 88-97% range
            
            // Customer satisfaction (simulated)
            const satisfaction = (4.6 + Math.random() * 0.4).toFixed(1);
            
            updateElement('ordersWithTrackingPercent', `${trackingPercentage}%`);
            updateElement('sameDayProcessing', `${sameDayRate}%`);
            updateElement('onTimeDelivery', `${onTimeRate}%`);
            updateElement('customerSatisfaction', `${satisfaction}/5`);
        }

        function updateTopProductsAnalytics() {
            // Calculate product revenue from orders
            const productRevenue = {};
            
            orders.forEach(order => {
                // Parse order items to extract product names and quantities
                const items = order.items.split(', ');
                items.forEach(item => {
                    const match = item.match(/^(.+?)\s*\(x(\d+)\)$/);
                    if (match) {
                        const productName = match[1].trim();
                        const quantity = parseInt(match[2]);
                        
                        // Find matching product to get price
                        const product = products.find(p => 
                            p.strain.toLowerCase().includes(productName.toLowerCase()) ||
                            productName.toLowerCase().includes(p.strain.toLowerCase())
                        );
                        
                        if (product) {
                            const revenue = product.price * quantity;
                            productRevenue[productName] = (productRevenue[productName] || 0) + revenue;
                        }
                    }
                });
            });
            
            // Sort by revenue and get top products
            const sortedProducts = Object.entries(productRevenue)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 5);
            
            const topProductsHtml = sortedProducts.length > 0 ? 
                sortedProducts.map(([name, revenue]) => `
                    <div style="display: flex; justify-content: space-between; margin-bottom: 12px; padding: 8px; background: var(--surface-elevated); border-radius: 6px;">
                        <span>${name}</span>
                        <strong style="color: var(--brand-green);">${revenue.toLocaleString()}</strong>
                    </div>
                `).join('') :
                `<div style="text-align: center; color: var(--text-muted); padding: 20px;">
                    No product revenue data available
                </div>`;
            
            document.getElementById('topProductsAnalytics').innerHTML = topProductsHtml;
        }

        function updatePartnerPerformanceAnalytics() {
            // Calculate partner revenue from orders
            const partnerRevenue = {};
            
            orders.forEach(order => {
                partnerRevenue[order.partnerName] = (partnerRevenue[order.partnerName] || 0) + order.total;
            });
            
            // Sort by revenue and get top partners
            const sortedPartners = Object.entries(partnerRevenue)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 5);
            
            const partnerPerformanceHtml = sortedPartners.length > 0 ? 
                sortedPartners.map(([name, revenue]) => `
                    <div style="display: flex; justify-content: space-between; margin-bottom: 12px; padding: 8px; background: var(--surface-elevated); border-radius: 6px;">
                        <span>${name}</span>
                        <strong style="color: var(--brand-green);">${revenue.toLocaleString()}</strong>
                    </div>
                `).join('') :
                `<div style="text-align: center; color: var(--text-muted); padding: 20px;">
                    No partner revenue data available
                </div>`;
            
            document.getElementById('partnerPerformanceAnalytics').innerHTML = partnerPerformanceHtml;
        }

        function updateOrderStatusDistribution() {
            const statusCounts = {
                'PENDING': orders.filter(o => o.status === 'PENDING').length,
                'PROCESSING': orders.filter(o => o.status === 'PROCESSING').length,
                'SHIPPED': orders.filter(o => o.status === 'SHIPPED').length,
                'DELIVERED': orders.filter(o => o.status === 'DELIVERED').length
            };
            
            updateElement('pendingCount', statusCounts.PENDING);
            updateElement('processingCount', statusCounts.PROCESSING);
            updateElement('shippedCount', statusCounts.SHIPPED);
            updateElement('deliveredCount', statusCounts.DELIVERED);
        }

        function updateWeeklyOrderVolume() {
            const now = new Date();
            const oneWeekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
            const twoWeeksAgo = new Date(now.getTime() - 14 * 24 * 60 * 60 * 1000);
            
            const thisWeekOrders = orders.filter(order => {
                const orderDate = new Date(order.date);
                return orderDate >= oneWeekAgo;
            }).length;
            
            const lastWeekOrders = orders.filter(order => {
                const orderDate = new Date(order.date);
                return orderDate >= twoWeeksAgo && orderDate < oneWeekAgo;
            }).length;
            
            const monthlyAvg = Math.round(orders.length / 4); // Rough monthly average
            
            const weeklyGrowth = lastWeekOrders > 0 ? 
                Math.round(((thisWeekOrders - lastWeekOrders) / lastWeekOrders) * 100) : 100;
            
            updateElement('thisWeekOrders', `${thisWeekOrders} orders`);
            updateElement('lastWeekOrders', `${lastWeekOrders} orders`);
            updateElement('monthlyAvgOrders', `${monthlyAvg} orders`);
            updateElement('weeklyGrowth', `${weeklyGrowth >= 0 ? '+' : ''}${weeklyGrowth}% vs last week`);
        }

        function updateAnalyticsTimeframe(timeframe) {
            // Filter orders based on timeframe
            let filteredOrders = orders;
            const now = new Date();
            
            switch(timeframe) {
                case '30':
                    const thirtyDaysAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
                    filteredOrders = orders.filter(o => new Date(o.date) >= thirtyDaysAgo);
                    break;
                case '90':
                    const ninetyDaysAgo = new Date(now.getTime() - 90 * 24 * 60 * 60 * 1000);
                    filteredOrders = orders.filter(o => new Date(o.date) >= ninetyDaysAgo);
                    break;
                case '365':
                    const oneYearAgo = new Date(now.getTime() - 365 * 24 * 60 * 60 * 1000);
                    filteredOrders = orders.filter(o => new Date(o.date) >= oneYearAgo);
                    break;
            }
            
            // Temporarily replace orders array for analytics calculation
            const originalOrders = [...orders];
            orders.splice(0, orders.length, ...filteredOrders);
            
            // Update analytics with filtered data
            updateAnalyticsDashboard();
            
            // Restore original orders
            orders.splice(0, orders.length, ...originalOrders);
            
            showNotification(`📊 Analytics updated for ${timeframe === 'custom' ? 'custom' : timeframe + ' days'} timeframe`, 'success');
        }

        function refreshAnalytics() {
            updateAnalyticsDashboard();
            showNotification('🔄 Analytics data refreshed!', 'success');
        }

        function generateExecutiveReport() {
            const totalRevenue = orders.reduce((sum, o) => sum + o.total, 0);
            const totalOrders = orders.length;
            const ordersWithTracking = orders.filter(o => o.trackingNumber).length;
            const fulfillmentRate = totalOrders > 0 ? Math.round((ordersWithTracking / totalOrders) * 100) : 0;
            
            const reportWindow = window.open('', '_blank', 'width=800,height=1000');
            reportWindow.document.write(`
                <html>
                <head>
                    <title>Executive Report - Faded Skies Wholesale</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 40px; line-height: 1.6; }
                        .header { text-align: center; margin-bottom: 40px; border-bottom: 2px solid #00C851; padding-bottom: 20px; }
                        .metrics { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin: 30px 0; }
                        .metric { text-align: center; padding: 20px; background: #f8f9fa; border-radius: 8px; }
                        .metric-value { font-size: 2rem; font-weight: bold; color: #00C851; }
                        .section { margin: 30px 0; }
                        .section h3 { color: #00C851; border-bottom: 1px solid #ddd; padding-bottom: 10px; }
                        @media print { .no-print { display: none; } }
                    </style>
                </head>
                <body>
                    <div class="no-print" style="text-align: center; margin-bottom: 20px;">
                        <button onclick="window.print()" style="padding: 10px 20px; background: #00C851; color: white; border: none; border-radius: 4px; cursor: pointer;">🖨️ Print Report</button>
                    </div>
                    
                    <div class="header">
                        <h1>🌿 Faded Skies Wholesale</h1>
                        <h2>Executive Performance Report</h2>
                        <p>Generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}</p>
                    </div>
                    
                    <div class="metrics">
                        <div class="metric">
                            <div class="metric-value">${totalRevenue.toLocaleString()}</div>
                            <div>Total Revenue</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">${totalOrders}</div>
                            <div>Total Orders</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">${fulfillmentRate}%</div>
                            <div>Fulfillment Rate</div>
                        </div>
                    </div>
                    
                    <div class="section">
                        <h3>📊 Key Performance Indicators</h3>
                        <ul>
                            <li><strong>Average Order Value:</strong> ${Math.round(totalRevenue / totalOrders)}</li>
                            <li><strong>Orders with Tracking:</strong> ${ordersWithTracking}/${totalOrders} (${fulfillmentRate}%)</li>
                            <li><strong>Partner Count:</strong> ${partners.length} active partners</li>
                            <li><strong>Product Catalog:</strong> ${products.length} products available</li>
                            <li><strong>Available Inventory:</strong> ${products.filter(p => p.status === 'AVAILABLE').length} products in stock</li>
                        </ul>
                    </div>
                    
                    <div class="section">
                        <h3>📈 Growth & Trends</h3>
                        <ul>
                            <li><strong>Order Growth:</strong> Tracking ${orders.length} total orders with strong upward trend</li>
                            <li><strong>Revenue Performance:</strong> ${totalRevenue.toLocaleString()} total revenue generated</li>
                            <li><strong>Operational Efficiency:</strong> ${fulfillmentRate}% of orders have tracking information</li>
                            <li><strong>Customer Satisfaction:</strong> High satisfaction with tracking and delivery performance</li>
                        </ul>
                    </div>
                    
                    <div class="section">
                        <h3>🎯 Recommendations</h3>
                        <ul>
                            <li>Continue focus on same-day order processing</li>
                            <li>Maintain high standards for tracking information</li>
                            <li>Expand product catalog based on demand patterns</li>
                            <li>Strengthen partner relationships through improved service</li>
                            <li>Implement automated tracking notifications for all orders</li>
                        </ul>
                    </div>
                    
                    <div class="section">
                        <h3>📞 Contact Information</h3>
                        <p>
                            <strong>Faded Skies Wholesale</strong><br>
                            123 Cannabis Ave, Helotes, TX 78023<br>
                            Phone: (210) 835-7834<br>
                            Email: info@fadedskies.com
                        </p>
                    </div>
                </body>
                </html>
            `);
            
            showNotification('📋 Executive report generated successfully!', 'success');
        }

        function exportAnalytics() {
            const analyticsData = {
                reportDate: new Date().toISOString(),
                summary: {
                    totalRevenue: orders.reduce((sum, o) => sum + o.total, 0),
                    totalOrders: orders.length,
                    avgOrderValue: orders.length > 0 ? orders.reduce((sum, o) => sum + o.total, 0) / orders.length : 0,
                    fulfillmentRate: orders.length > 0 ? (orders.filter(o => o.trackingNumber).length / orders.length) * 100 : 0
                },
                ordersByStatus: {
                    pending: orders.filter(o => o.status === 'PENDING').length,
                    processing: orders.filter(o => o.status === 'PROCESSING').length,
                    shipped: orders.filter(o => o.status === 'SHIPPED').length,
                    delivered: orders.filter(o => o.status === 'DELIVERED').length
                },
                partnerCount: partners.length,
                productCount: products.length
            };
            
            const csvContent = 'data:text/csv;charset=utf-8,' + 
                'Metric,Value\n' +
                `Total Revenue,${analyticsData.summary.totalRevenue.toLocaleString()}\n` +
                `Total Orders,${analyticsData.summary.totalOrders}\n` +
                `Average Order Value,${Math.round(analyticsData.summary.avgOrderValue)}\n` +
                `Fulfillment Rate,${Math.round(analyticsData.summary.fulfillmentRate)}%\n` +
                `Pending Orders,${analyticsData.ordersByStatus.pending}\n` +
                `Processing Orders,${analyticsData.ordersByStatus.processing}\n` +
                `Shipped Orders,${analyticsData.ordersByStatus.shipped}\n` +
                `Delivered Orders,${analyticsData.ordersByStatus.delivered}\n` +
                `Active Partners,${analyticsData.partnerCount}\n` +
                `Available Products,${analyticsData.productCount}`;
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement('a');
            link.setAttribute('href', encodedUri);
            link.setAttribute('download', 'faded_skies_analytics_report.csv');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('📊 Analytics report exported successfully!', 'success');
        }

        function generatePartnerReport() {
            const partnerReportData = partners.map(partner => {
                const partnerOrders = orders.filter(o => o.partner === partner.email);
                const partnerRevenue = partnerOrders.reduce((sum, o) => sum + o.total, 0);
                return {
                    ...partner,
                    orderCount: partnerOrders.length,
                    revenue: partnerRevenue,
                    avgOrderValue: partnerOrders.length > 0 ? partnerRevenue / partnerOrders.length : 0
                };
            });
            
            const csvContent = 'data:text/csv;charset=utf-8,' + 
                'Partner Name,Email,Business Type,Tier,Status,Order Count,Total Revenue,Avg Order Value,Credit Limit,Join Date\n' +
                partnerReportData.map(p => 
                    `"${p.businessName}",${p.email},${p.businessType},${p.tier},${p.status},${p.orderCount},${p.revenue.toFixed(2)},${p.avgOrderValue.toFixed(2)},${p.creditLimit},${p.joinDate}`
                ).join('\n');
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement('a');
            link.setAttribute('href', encodedUri);
            link.setAttribute('download', 'faded_skies_partner_performance_report.csv');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('📊 Partner performance report exported successfully!', 'success');
        }

        function runPriceOptimization() {
            showNotification('🤖 AI price optimization running...', 'success');
            
            setTimeout(() => {
                // Simulate AI price optimization
                let optimized = 0;
                products.forEach(product => {
                    if (Math.random() < 0.3) { // 30% chance of optimization
                        const adjustment = (Math.random() - 0.5) * 0.1; // ±5% adjustment
                        product.price = Math.round(product.price * (1 + adjustment));
                        product.lastModified = new Date().toISOString();
                        product.modifiedBy = 'ai-optimizer';
                        optimized++;
                    }
                });
                
                updateAllDashboardViews();
                showNotification(`🎯 AI optimization complete! ${optimized} prices updated.`, 'success');
                syncToPortal();
            }, 3000);
        }

        function applyMarketAnalysis() {
            showNotification('📊 Market analysis applied to pricing strategy!', 'success');
        }

        // Partner Management Functions
        function updatePartnersTable() {
            const tbody = document.getElementById('partnersBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            partners.forEach(partner => {
                const row = document.createElement('tr');
                const tierColor = {
                    'Gold': 'var(--accent-orange)',
                    'Silver': 'var(--text-secondary)', 
                    'Bronze': '#CD7F32',
                    'Platinum': '#E5E4E2'
                }[partner.tier] || 'var(--text-secondary)';
                
                const statusColor = {
                    'Active': 'var(--brand-green)',
                    'Pending': 'var(--accent-orange)',
                    'Review': 'var(--accent-orange)',
                    'Suspended': 'var(--accent-red)'
                }[partner.status] || 'var(--text-secondary)';
                
                row.innerHTML = `
                    <td>
                        <strong>${partner.businessName}</strong><br>
                        <small style="color: var(--text-muted);">${partner.email}</small><br>
                        <small style="color: var(--text-muted);">License: ${partner.licenseNumber}</small>
                    </td>
                    <td>
                        <strong>${partner.contactName}</strong><br>
                        <small style="color: var(--text-muted);">${partner.phone}</small><br>
                        <small style="color: var(--text-muted);">${partner.address}</small>
                    </td>
                    <td>${partner.businessType}</td>
                    <td>
                        <span style="color: ${tierColor}; font-weight: bold;">${partner.tier}</span><br>
                        <span style="color: ${statusColor}; font-weight: bold;">${partner.status}</span>
                    </td>
                    <td>
                        <strong>${partner.totalOrders} orders</strong><br>
                        <span style="color: var(--brand-green); font-weight: bold;">${partner.totalRevenue.toLocaleString()}</span><br>
                        <small style="color: var(--text-muted);">Last: ${formatDate(partner.lastOrder)}</small>
                    </td>
                    <td>
                        <strong>${partner.creditLimit.toLocaleString()}</strong><br>
                        <small>${partner.paymentTerms}</small><br>
                        <small style="color: var(--brand-green);">${getDiscountRate(partner.tier)}% discount</small>
                    </td>
                    <td>
                        <small style="color: var(--text-muted);">Login: ${formatDateTime(partner.lastLogin)}</small><br>
                        <small style="color: var(--text-muted);">Joined: ${formatDate(partner.joinDate)}</small>
                    </td>
                    <td>
                        <button class="btn btn-secondary btn-sm" onclick="editPartner(${partner.id})">Edit</button>
                        <button class="btn btn-primary btn-sm" onclick="emailPartner('${partner.email}')">Email</button>
                        <button class="btn btn-admin btn-sm" onclick="generatePasswordReset(${partner.id})">Reset PW</button>
                        <button class="btn btn-danger btn-sm" onclick="deletePartner(${partner.id})">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updatePartnerStats() {
            const totalPartners = partners.length;
            const activePartners = partners.filter(p => p.status === 'Active').length;
            const newPartners = partners.filter(p => {
                const joinDate = new Date(p.joinDate);
                const monthAgo = new Date();
                monthAgo.setMonth(monthAgo.getMonth() - 1);
                return joinDate > monthAgo;
            }).length;
            const avgRevenue = totalPartners > 0 ? Math.round(partners.reduce((sum, p) => sum + p.totalRevenue, 0) / totalPartners) : 0;
            
            updateElement('totalPartners', totalPartners);
            updateElement('activePartners', activePartners);
            updateElement('newPartners', newPartners);
            updateElement('avgPartnerRevenue', `${avgRevenue.toLocaleString()}`);
        }

        function getDiscountRate(tier) {
            const rates = { 'Bronze': 5, 'Silver': 10, 'Gold': 15, 'Platinum': 20 };
            return rates[tier] || 0;
        }

        function addPartner(event) {
            event.preventDefault();
            
            const partnerData = {
                id: nextPartnerId++,
                email: document.getElementById('newPartnerEmail').value,
                businessName: document.getElementById('newPartnerBusinessName').value,
                contactName: document.getElementById('newPartnerContactName').value,
                phone: document.getElementById('newPartnerPhone').value,
                address: document.getElementById('newPartnerAddress').value,
                businessType: document.getElementById('newPartnerBusinessType').value,
                licenseNumber: document.getElementById('newPartnerLicense').value,
                tier: document.getElementById('newPartnerTier').value,
                status: document.getElementById('newPartnerStatus').value,
                creditLimit: parseInt(document.getElementById('newPartnerCreditLimit').value) || 5000,
                paymentTerms: document.getElementById('newPartnerPaymentTerms').value,
                discountRate: getDiscountRate(document.getElementById('newPartnerTier').value),
                notes: document.getElementById('newPartnerNotes').value,
                totalOrders: 0,
                totalRevenue: 0,
                lastOrder: null,
                joinDate: new Date().toISOString().split('T')[0],
                lastLogin: null,
                passwordResetToken: null,
                passwordResetExpires: null,
                createdAt: new Date().toISOString(),
                modifiedAt: new Date().toISOString()
            };
            
            // Check for duplicate email
            if (partners.find(p => p.email === partnerData.email)) {
                showNotification('A partner with this email already exists', 'error');
                return;
            }
            
            partners.push(partnerData);
            
            // Send welcome email if checked
            const sendWelcome = document.getElementById('sendWelcomeEmail').checked;
            if (sendWelcome) {
                sendPartnerWelcomeEmail(partnerData);
            }
            
            updateAllDashboardViews();
            closeModal('addPartnerModal');
            showNotification(`✅ Partner ${partnerData.businessName} added successfully!`, 'success');
            
            // Reset form
            event.target.reset();
        }

        function editPartner(partnerId) {
            const partner = partners.find(p => p.id === partnerId);
            if (!partner) {
                showNotification('Partner not found', 'error');
                return;
            }
            
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 800px;">
                    <div class="modal-header">
                        <h3 class="modal-title">✏️ Edit Partner - ${partner.businessName}</h3>
                        <button class="modal-close" onclick="this.closest('.modal').remove(); document.body.style.overflow = 'auto';">×</button>
                    </div>
                    <form id="editPartnerForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Business Name *</label>
                                <input type="text" id="editBusinessName" value="${partner.businessName}" required>
                            </div>
                            <div class="form-group">
                                <label>Contact Name *</label>
                                <input type="text" id="editContactName" value="${partner.contactName}" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Email Address *</label>
                                <input type="email" id="editEmail" value="${partner.email}" required>
                            </div>
                            <div class="form-group">
                                <label>Phone Number *</label>
                                <input type="tel" id="editPhone" value="${partner.phone}" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Business Address *</label>
                            <input type="text" id="editAddress" value="${partner.address}" required>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Business Type *</label>
                                <select id="editBusinessType" required>
                                    <option value="Licensed Dispensary" ${partner.businessType === 'Licensed Dispensary' ? 'selected' : ''}>Licensed Dispensary</option>
                                    <option value="Smoke Shop" ${partner.businessType === 'Smoke Shop' ? 'selected' : ''}>Smoke Shop</option>
                                    <option value="CBD Store" ${partner.businessType === 'CBD Store' ? 'selected' : ''}>CBD Store</option>
                                    <option value="Delivery Service" ${partner.businessType === 'Delivery Service' ? 'selected' : ''}>Delivery Service</option>
                                    <option value="Distributor" ${partner.businessType === 'Distributor' ? 'selected' : ''}>Distributor</option>
                                    <option value="Other" ${partner.businessType === 'Other' ? 'selected' : ''}>Other</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>License Number *</label>
                                <input type="text" id="editLicense" value="${partner.licenseNumber}" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Partner Tier</label>
                                <select id="editTier">
                                    <option value="Bronze" ${partner.tier === 'Bronze' ? 'selected' : ''}>Bronze (5% discount)</option>
                                    <option value="Silver" ${partner.tier === 'Silver' ? 'selected' : ''}>Silver (10% discount)</option>
                                    <option value="Gold" ${partner.tier === 'Gold' ? 'selected' : ''}>Gold (15% discount)</option>
                                    <option value="Platinum" ${partner.tier === 'Platinum' ? 'selected' : ''}>Platinum (20% discount)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Credit Limit ($)</label>
                                <input type="number" id="editCreditLimit" value="${partner.creditLimit}" step="100">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Payment Terms</label>
                                <select id="editPaymentTerms">
                                    <option value="Immediate Payment" ${partner.paymentTerms === 'Immediate Payment' ? 'selected' : ''}>Immediate Payment</option>
                                    <option value="Net 15" ${partner.paymentTerms === 'Net 15' ? 'selected' : ''}>Net 15 Days</option>
                                    <option value="Net 30" ${partner.paymentTerms === 'Net 30' ? 'selected' : ''}>Net 30 Days</option>
                                    <option value="Net 60" ${partner.paymentTerms === 'Net 60' ? 'selected' : ''}>Net 60 Days</option>
                                    <option value="Prepaid Only" ${partner.paymentTerms === 'Prepaid Only' ? 'selected' : ''}>Prepaid Only</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Status</label>
                                <select id="editStatus">
                                    <option value="Active" ${partner.status === 'Active' ? 'selected' : ''}>Active</option>
                                    <option value="Pending" ${partner.status === 'Pending' ? 'selected' : ''}>Pending Approval</option>
                                    <option value="Review" ${partner.status === 'Review' ? 'selected' : ''}>Under Review</option>
                                    <option value="Suspended" ${partner.status === 'Suspended' ? 'selected' : ''}>Suspended</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Notes</label>
                            <textarea id="editNotes" rows="3">${partner.notes || ''}</textarea>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;">Save Changes</button>
                    </form>
                </div>
            `;
            document.body.appendChild(modal);
            document.body.style.overflow = 'hidden';
            
            // Handle form submit
            modal.querySelector('#editPartnerForm').onsubmit = function(e) {
                e.preventDefault();
                
                // Update partner data
                partner.businessName = modal.querySelector('#editBusinessName').value;
                partner.contactName = modal.querySelector('#editContactName').value;
                partner.email = modal.querySelector('#editEmail').value;
                partner.phone = modal.querySelector('#editPhone').value;
                partner.address = modal.querySelector('#editAddress').value;
                partner.businessType = modal.querySelector('#editBusinessType').value;
                partner.licenseNumber = modal.querySelector('#editLicense').value;
                partner.tier = modal.querySelector('#editTier').value;
                partner.creditLimit = parseInt(modal.querySelector('#editCreditLimit').value);
                partner.paymentTerms = modal.querySelector('#editPaymentTerms').value;
                partner.status = modal.querySelector('#editStatus').value;
                partner.notes = modal.querySelector('#editNotes').value;
                partner.discountRate = getDiscountRate(partner.tier);
                partner.modifiedAt = new Date().toISOString();
                
                updateAllDashboardViews();
                showNotification(`✅ Partner ${partner.businessName} updated successfully!`, 'success');
                modal.remove();
                document.body.style.overflow = 'auto';
            };
        }

        function deletePartner(partnerId) {
            const partner = partners.find(p => p.id === partnerId);
            if (partner && confirm(`Are you sure you want to delete ${partner.businessName}? This will also disable their portal access.`)) {
                partners = partners.filter(p => p.id !== partnerId);
                updateAllDashboardViews();
                showNotification(`🗑️ Partner ${partner.businessName} deleted and portal access revoked`, 'success');
            }
        }

        function emailPartner(email) {
            const partner = partners.find(p => p.email === email);
            if (!partner) {
                showNotification('Partner not found', 'error');
                return;
            }
            
            // Pre-fill bulk email modal with single partner
            document.getElementById('selectedRecipients').textContent = `${partner.businessName} (${partner.email})`;
            document.getElementById('emailSubject').value = `Message from Faded Skies Wholesale`;
            document.getElementById('emailMessage').value = `Dear ${partner.contactName},\n\n\n\nBest regards,\nFaded Skies Wholesale Team`;
            
            // Set custom recipient mode
            window.customEmailRecipient = email;
            
            openModal('bulkEmailModal');
        }

        function sendPartnerWelcomeEmail(partner) {
            const welcomeMessage = `
Dear ${partner.contactName},

Welcome to Faded Skies Wholesale! 🎉

Your wholesale partner account has been successfully created. Here are your account details:

Business: ${partner.businessName}
Partner Tier: ${partner.tier} (${getDiscountRate(partner.tier)}% discount)
Credit Limit: ${partner.creditLimit.toLocaleString()}
Payment Terms: ${partner.paymentTerms}

PORTAL ACCESS:
🌐 Login URL: https://portal.fadedskies.com
📧 Username: ${partner.email}
🔑 Password: Please use the "Forgot Password" link to set your initial password

Your account provides access to:
✅ Live inventory and pricing
✅ Order management and tracking  
✅ Account statements and invoices
✅ Product catalogs and updates

Welcome to the Faded Skies family!

Best regards,
Faded Skies Wholesale Team
(210) 835-7834
            `;
            
            console.log('📧 Welcome email sent to:', partner.email);
            showNotification(`📧 Welcome email sent to ${partner.contactName}`, 'success');
        }

        // Password Reset Functions
        function generatePasswordReset(partnerId) {
            const partner = partners.find(p => p.id === partnerId);
            if (!partner) {
                showNotification('Partner not found', 'error');
                return;
            }
            
            if (partner.status === 'Suspended') {
                showNotification('Cannot generate reset for suspended partner', 'error');
                return;
            }
            
            // Generate reset token
            const resetToken = 'pwd_reset_' + Math.random().toString(36).substr(2, 16);
            const expiresAt = new Date();
            expiresAt.setHours(expiresAt.getHours() + 24); // 24 hour expiry
            
            partner.passwordResetToken = resetToken;
            partner.passwordResetExpires = expiresAt.toISOString();
            
            const resetLink = `https://portal.fadedskies.com/reset-password?token=${resetToken}`;
            
            console.log('🔑 Password reset generated for:', partner.email);
            console.log('🔗 Reset link:', resetLink);
            
            showNotification(`🔑 Password reset link generated for ${partner.businessName}`, 'success');
            
            // Update password reset table if modal is open
            if (document.getElementById('passwordResetModal').style.display === 'block') {
                updatePasswordResetTable();
            }
        }

        function generatePartnerResetLinks() {
            let generated = 0;
            partners.forEach(partner => {
                if (partner.status !== 'Suspended') {
                    generatePasswordReset(partner.id);
                    generated++;
                }
            });
            showNotification(`🔗 Generated ${generated} password reset links`, 'success');
        }

        function sendBulkPasswordResets() {
            const eligiblePartners = partners.filter(p => p.status !== 'Suspended');
            
            eligiblePartners.forEach(partner => {
                if (!partner.passwordResetToken) {
                    generatePasswordReset(partner.id);
                }
                
                console.log(`📧 Password reset email sent to: ${partner.email}`);
            });
            
            showNotification(`📧 Password reset emails sent to ${eligiblePartners.length} partners`, 'success');
        }

        function updatePasswordResetTable() {
            const tbody = document.getElementById('passwordResetBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            partners.forEach(partner => {
                const hasToken = partner.passwordResetToken !== null;
                const isExpired = hasToken && new Date(partner.passwordResetExpires) < new Date();
                const resetStatus = !hasToken ? 'No Token' : isExpired ? 'Expired' : 'Active';
                const statusColor = resetStatus === 'Active' ? 'var(--brand-green)' : 
                                   resetStatus === 'Expired' ? 'var(--accent-red)' : 'var(--text-muted)';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <strong>${partner.businessName}</strong><br>
                        <small style="color: var(--text-muted);">${partner.contactName}</small>
                    </td>
                    <td>${partner.email}</td>
                    <td>
                        <span style="color: ${statusColor}; font-weight: bold;">${resetStatus}</span>
                        ${partner.status === 'Suspended' ? '<br><small style="color: var(--accent-red);">Account Suspended</small>' : ''}
                    </td>
                    <td>
                        ${hasToken ? `<code style="font-size: 11px;">${partner.passwordResetToken.substr(0, 20)}...</code>` : '-'}
                    </td>
                    <td>
                        ${hasToken ? formatDateTime(partner.passwordResetExpires) : '-'}
                    </td>
                    <td>
                        ${partner.lastLogin ? formatDateTime(partner.lastLogin) : 'Never'}
                    </td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="generatePasswordReset(${partner.id})" 
                                ${partner.status === 'Suspended' ? 'disabled' : ''}>
                            Generate
                        </button>
                        ${hasToken && !isExpired ? `<button class="btn btn-secondary btn-sm" onclick="copyResetLink(${partner.id})">Copy Link</button>` : ''}
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function copyResetLink(partnerId) {
            const partner = partners.find(p => p.id === partnerId);
            if (partner && partner.passwordResetToken) {
                const resetLink = `https://portal.fadedskies.com/reset-password?token=${partner.passwordResetToken}`;
                navigator.clipboard.writeText(resetLink).then(() => {
                    showNotification('🔗 Reset link copied to clipboard', 'success');
                }).catch(() => {
                    showNotification('Failed to copy link', 'error');
                });
            }
        }

        function refreshPasswordResetTable() {
            updatePasswordResetTable();
            showNotification('🔄 Password reset table refreshed', 'success');
        }

        // Bulk Email Functions
        let emailRecipientFilter = 'all';
        let customEmailRecipient = null;

        function toggleEmailRecipients(filter) {
            emailRecipientFilter = filter;
            customEmailRecipient = null;
            
            // Update button states
            document.querySelectorAll('#bulkEmailModal .filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update recipient display
            const recipients = getEmailRecipients();
            const count = recipients.length;
            const recipientText = filter === 'all' ? `All partners selected (${count} recipients)` :
                                 filter === 'active' ? `Active partners selected (${count} recipients)` :
                                 `${filter.charAt(0).toUpperCase() + filter.slice(1)} tier partners selected (${count} recipients)`;
            
            document.getElementById('selectedRecipients').textContent = recipientText;
        }

        function getEmailRecipients() {
            if (customEmailRecipient) {
                return partners.filter(p => p.email === customEmailRecipient);
            }
            
            switch(emailRecipientFilter) {
                case 'active': return partners.filter(p => p.status === 'Active');
                case 'gold': return partners.filter(p => p.tier === 'Gold');
                case 'silver': return partners.filter(p => p.tier === 'Silver');
                case 'bronze': return partners.filter(p => p.tier === 'Bronze');
                default: return partners;
            }
        }

        function loadEmailTemplate() {
            const template = document.getElementById('emailTemplate').value;
            const templates = {
                new_products: {
                    subject: '🌿 New Products Available - Faded Skies Wholesale',
                    message: `Dear Partners,

We're excited to announce new premium products now available in our wholesale catalog!

🆕 NEW ARRIVALS:
• Premium A-Grade strains with exceptional THCA content
• Craft rosin and concentrate selections
• Limited edition seasonal offerings

🚀 HIGHLIGHTS:
• Competitive wholesale pricing
• Same-day processing for orders
• Quality guaranteed products

Log into your partner portal to view the complete catalog and place orders:
🌐 https://portal.fadedskies.com

Best regards,
Faded Skies Wholesale Team`
                },
                price_update: {
                    subject: '💰 Price Update Notification - Faded Skies Wholesale',
                    message: `Dear Partners,

This message is to inform you of recent pricing updates in our wholesale catalog.

📊 PRICING CHANGES:
• Effective immediately
• Updated pricing reflects current market conditions
• Your tier discounts remain unchanged

Please review the updated pricing in your partner portal:
🌐 https://portal.fadedskies.com

Thank you for your continued partnership.

Best regards,
Faded Skies Wholesale Team`
                },
                inventory_alert: {
                    subject: '⚠️ Low Inventory Alert - Faded Skies Wholesale',
                    message: `Dear Partners,

This is a notification that several popular items are running low in stock.

📦 LOW INVENTORY ITEMS:
• High-demand A-Grade strains
• Popular concentrate products
• Best-selling vape cartridges

We recommend placing orders soon to avoid stock-outs.

Order now through your partner portal:
🌐 https://portal.fadedskies.com

Best regards,
Faded Skies Wholesale Team`
                },
                payment_reminder: {
                    subject: '💳 Payment Reminder - Faded Skies Wholesale',
                    message: `Dear Partners,

This is a friendly reminder regarding your account and payment terms.

📋 ACCOUNT REMINDERS:
• Orders require immediate payment upon placement
��� Credit terms available for approved partners only
• Please ensure payment methods are up to date
• Contact us for any payment or billing questions

💳 PAYMENT OPTIONS:
• Secure online payment through partner portal
• Credit/debit cards accepted
• ACH transfers for larger orders
• Net terms available with credit approval

Access your account details through the partner portal:
🌐 https://portal.fadedskies.com

Thank you for your continued partnership.

Best regards,
Faded Skies Wholesale Team`
                },
                newsletter: {
                    subject: '📰 Monthly Newsletter - Faded Skies Wholesale',
                    message: `Dear Partners,

Welcome to this month's Faded Skies Wholesale newsletter!

🎯 THIS MONTH'S HIGHLIGHTS:
• Industry market trends and insights
• New product announcements and arrivals
• Partnership program updates and tier benefits
• Educational resources and compliance updates

📈 PARTNERSHIP BENEFITS:
• Exclusive pricing tiers with automatic discounts
• Priority access to limited and premium products
• Immediate order processing with secure payment
• Dedicated support team and account management
• Fast processing and reliable shipping

💳 PAYMENT & ORDERING:
• Streamlined checkout with immediate payment processing
• Secure payment methods for all transactions
• Credit terms available for qualified partners
• Real-time inventory and instant order confirmation

Stay connected with us:
🌐 Partner Portal: https://portal.fadedskies.com
📞 Phone: (210) 835-7834
📧 Email: support@fadedskies.com

Best regards,
Faded Skies Wholesale Team`
                }
            };
            
            if (templates[template]) {
                document.getElementById('emailSubject').value = templates[template].subject;
                document.getElementById('emailMessage').value = templates[template].message;
            }
        }

        function previewEmail() {
            const subject = document.getElementById('emailSubject').value;
            const message = document.getElementById('emailMessage').value;
            const recipients = getEmailRecipients();
            
            const previewWindow = window.open('', '_blank', 'width=600,height=500');
            previewWindow.document.write(`
                <html>
                <head><title>Email Preview</title></head>
                <body style="font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5;">
                    <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <h2 style="color: #00C851;">Email Preview</h2>
                        <p><strong>Recipients:</strong> ${recipients.length} partners</p>
                        <p><strong>Subject:</strong> ${subject}</p>
                        <hr>
                        <div style="white-space: pre-wrap; line-height: 1.6;">${message}</div>
                    </div>
                </body>
                </html>
            `);
        }

        function sendBulkEmail(event) {
            event.preventDefault();
            
            const subject = document.getElementById('emailSubject').value;
            const message = document.getElementById('emailMessage').value;
            const recipients = getEmailRecipients();
            
            if (recipients.length === 0) {
                showNotification('No recipients selected', 'error');
                return;
            }
            
            // Simulate sending emails
            console.log('📧 Bulk email sent:');
            console.log('Subject:', subject);
            console.log('Recipients:', recipients.map(p => p.email));
            console.log('Message:', message);
            
            closeModal('bulkEmailModal');
            showNotification(`📧 Email sent to ${recipients.length} partners successfully!`, 'success');
            
            // Reset form
            event.target.reset();
            emailRecipientFilter = 'all';
            customEmailRecipient = null;
        }

        // Additional System Functions
        function viewPartnerPortalLogs() {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 800px;">
                    <div class="modal-header">
                        <h3 class="modal-title">Partner Portal Activity Log ����</h3>
                        <button class="modal-close" onclick="this.closest('.modal').remove(); document.body.style.overflow = 'auto';">×</button>
                    </div>
                    <div>
                        <div style="background: var(--surface-elevated); padding: 16px; border-radius: 8px; margin-bottom: 20px;">
                            <h4 style="color: var(--brand-green); margin-bottom: 12px;">Recent Activity</h4>
                            <div style="font-family: monospace; font-size: 12px; color: var(--text-secondary); line-height: 1.8;">
                                <div>2025-06-29 10:45:23 - partner@store.com - LOGIN SUCCESS</div>
                                <div>2025-06-29 10:30:15 - dispensary@example.com - ORDER PLACED - ORD-002</div>
                                <div>2025-06-29 09:22:41 - hemp@heaven.co - PASSWORD RESET REQUESTED</div>
                                <div>2025-06-29 08:15:33 - partner@store.com - CATALOG ACCESSED</div>
                                <div>2025-06-28 16:45:12 - dispensary@example.com - LOGIN SUCCESS</div>
                                <div>2025-06-28 14:30:28 - unknown@email.com - LOGIN FAILED</div>
                                <div>2025-06-28 12:15:45 - partner@store.com - ORDER UPDATED - ORD-001</div>
                                <div>2025-06-28 11:22:33 - hemp@heaven.co - LOGIN SUCCESS</div>
                            </div>
                        </div>
                        <button class="btn btn-secondary" onclick="this.closest('.modal').remove(); document.body.style.overflow = 'auto';" style="width: 100%;">Close</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            document.body.style.overflow = 'hidden';
        }

        function viewSecurityLogs() {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 800px;">
                    <div class="modal-header">
                        <h3 class="modal-title">Security Audit Log 🔒</h3>
                        <button class="modal-close" onclick="this.closest('.modal').remove(); document.body.style.overflow = 'auto';">×</button>
                    </div>
                    <div>
                        <div style="background: var(--surface-elevated); padding: 16px; border-radius: 8px; margin-bottom: 20px;">
                            <h4 style="color: var(--accent-red); margin-bottom: 12px;">Security Events (Last 7 Days)</h4>
                            <div style="font-family: monospace; font-size: 12px; color: var(--text-secondary); line-height: 1.8;">
                                <div style="color: var(--accent-red);">2025-06-29 03:22:15 - 192.168.1.100 - FAILED LOGIN - unknown@email.com</div>
                                <div style="color: var(--accent-red);">2025-06-28 22:45:33 - 10.0.0.15 - FAILED LOGIN - admin@fake.com</div>
                                <div style="color: var(--accent-orange);">2025-06-28 14:30:45 - 192.168.1.50 - PASSWORD RESET - hemp@heaven.co</div>
                                <div style="color: var(--brand-green);">2025-06-27 10:15:22 - 192.168.1.25 - ADMIN LOGIN - admin@fadedskies.com</div>
                                <div style="color: var(--accent-red);">2025-06-26 18:33:11 - 10.0.0.22 - FAILED LOGIN - test@test.com</div>
                                <div style="color: var(--brand-green);">2025-06-26 09:45:18 - 192.168.1.30 - PARTNER LOGIN - partner@store.com</div>
                                <div style="color: var(--accent-orange);">2025-06-25 16:20:33 - 192.168.1.40 - ACCOUNT LOCKED - suspicious activity</div>
                            </div>
                        </div>
                        <div style="background: var(--surface-card); padding: 16px; border-radius: 8px; border: 1px solid var(--accent-orange);">
                            <h4 style="color: var(--accent-orange); margin-bottom: 12px;">⚠️ Security Recommendations</h4>
                            <ul style="color: var(--text-muted); font-size: 14px; line-height: 1.6;">
                                <li>Enable two-factor authentication for all partners</li>
                                <li>Review failed login attempts from unknown IPs</li>
                                <li>Consider implementing IP whitelisting for sensitive accounts</li>
                                <li>Regular security awareness training for partners</li>
                            </ul>
                        </div>
                        <button class="btn btn-secondary" onclick="this.closest('.modal').remove(); document.body.style.overflow = 'auto';" style="width: 100%; margin-top: 20px;">Close</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            document.body.style.overflow = 'hidden';
        }

        // System Functions
        function saveSettings() {
            showNotification('💾 Settings saved successfully!', 'success');
        }

        function backupSystem() {
            showNotification('📦 System backup initiated...', 'success');
            
            setTimeout(() => {
                showNotification('✅ System backup completed successfully!', 'success');
            }, 2000);
        }

        function resetSystem() {
            if (confirm('Are you sure you want to reset the system? This action cannot be undone.')) {
                showNotification('🔄 System reset functionality disabled for safety!', 'warning');
            }
        }

        function bulkStatusUpdate() {
            showNotification('🔄 Bulk status update functionality coming soon!', 'warning');
        }

        function generateShippingLabels() {
            showNotification('📦 Shipping label generation coming soon!', 'warning');
        }

        // Modal Functions
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';
                
                // Special initialization for specific modals
                if (modalId === 'passwordResetModal') {
                    updatePasswordResetTable();
                } else if (modalId === 'bulkEmailModal') {
                    // Reset email recipient filter
                    emailRecipientFilter = 'all';
                    customEmailRecipient = null;
                    const recipients = getEmailRecipients();
                    document.getElementById('selectedRecipients').textContent = `All partners selected (${recipients.length} recipients)`;
                    // Reset filter buttons
                    document.querySelectorAll('#bulkEmailModal .filter-btn').forEach(btn => btn.classList.remove('active'));
                    document.querySelector('#bulkEmailModal .filter-btn').classList.add('active');
                } else if (modalId === 'customerTrackingModal') {
                    // Clear previous tracking results
                    document.getElementById('customerLookupInput').value = '';
                    document.getElementById('customerTrackingResults').innerHTML = '';
                } else if (modalId === 'addTrackingModal') {
                    // Clear tracking form
                    document.getElementById('trackingNumber').value = '';
                    document.getElementById('trackingCarrier').value = '';
                    document.getElementById('estimatedDelivery').value = '';
                    document.getElementById('trackingUrl').value = '';
                    document.getElementById('shippingNotes').value = '';
                    document.getElementById('notifyCustomer').checked = true;
                }
            }
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        }

        // Tab Switching
        function switchTab(tabName) {
            // Remove active class from all tabs and contents
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // Add active class to clicked tab and corresponding content
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            // Update view based on tab
            if (tabName === 'pricing') {
                updatePricingTable();
                updatePricingAnalytics();
            } else if (tabName === 'analytics') {
                updateAnalyticsDashboard();
            } else if (tabName === 'partners') {
                updatePartnersTable();
                updatePartnerStats();
            } else if (tabName === 'applications') {
                loadApplicationsData();
            } else if (tabName === 'orders') {
                updateOrdersTable();
            }
        }

        // Utility Functions
        function formatDateTime(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString();
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Show notification
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            // Hide notification after 4 seconds
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }

        // Event Listeners for modal closing
        document.addEventListener('click', function(event) {
            if (event.target.classList.contains('modal')) {
                const modals = document.querySelectorAll('.modal');
                modals.forEach(modal => {
                    modal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                });
            }
        });

        // Auto-save functionality
        setInterval(() => {
            if (currentUser) {
                // Simulate auto-save
                console.log('🔄 Auto-saving data...');
            }
        }, 30000); // Every 30 seconds

        function previewProductPhoto(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('photoPreview').innerHTML = `<img src="${e.target.result}" alt="Photo" style="width:80px;height:80px;object-fit:cover;border-radius:8px;">`;
                    window._productPhotoData = e.target.result;
                };
                reader.readAsDataURL(file);
            } else {
                document.getElementById('photoPreview').innerHTML = '';
                window._productPhotoData = '';
            }
        }

        // Business Application Management Functions
        let currentApplications = [];
        let currentReviewingApplication = null;

        function loadApplicationsData() {
            try {
                currentApplications = JSON.parse(localStorage.getItem('businessApplications') || '[]');
                updateApplicationStats();
                populateApplicationsTable();
            } catch (error) {
                console.error('Error loading applications:', error);
                currentApplications = [];
            }
        }

        function updateApplicationStats() {
            const total = currentApplications.length;
            const pending = currentApplications.filter(app => app.status === 'pending').length;
            const approved = currentApplications.filter(app => app.status === 'approved').length;
            const rejected = currentApplications.filter(app => app.status === 'rejected').length;

            // Calculate average review time for processed applications
            const processedApps = currentApplications.filter(app => app.status !== 'pending' && app.reviewedDate);
            let avgReviewTime = 0;
            if (processedApps.length > 0) {
                const totalTime = processedApps.reduce((sum, app) => {
                    const reviewTime = new Date(app.reviewedDate) - new Date(app.submissionDate);
                    return sum + reviewTime;
                }, 0);
                avgReviewTime = Math.round((totalTime / processedApps.length) / (1000 * 60 * 60)); // Convert to hours
            }

            // Count today's applications
            const today = new Date().toDateString();
            const todaysApps = currentApplications.filter(app =>
                new Date(app.submissionDate).toDateString() === today
            ).length;

            // Update DOM elements
            if (document.getElementById('totalApplications')) document.getElementById('totalApplications').textContent = total;
            if (document.getElementById('pendingApplications')) document.getElementById('pendingApplications').textContent = pending;
            if (document.getElementById('approvedApplications')) document.getElementById('approvedApplications').textContent = approved;
            if (document.getElementById('rejectedApplications')) document.getElementById('rejectedApplications').textContent = rejected;
            if (document.getElementById('avgReviewTime')) document.getElementById('avgReviewTime').textContent = avgReviewTime;
            if (document.getElementById('todaysApplications')) document.getElementById('todaysApplications').textContent = todaysApps;
        }

        function populateApplicationsTable() {
            const tbody = document.getElementById('applicationsBody');
            if (!tbody) return;

            if (currentApplications.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 40px; color: var(--text-muted);">
                            📋 No business applications found. Applications will appear here when businesses submit partnership requests.
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = currentApplications.map(app => {
                const submissionDate = new Date(app.submissionDate).toLocaleDateString();
                const submissionTime = new Date(app.submissionDate).toLocaleTimeString();

                let statusClass = '';
                let statusText = '';
                switch (app.status) {
                    case 'pending':
                        statusClass = 'status-pending';
                        statusText = '⏳ Pending Review';
                        break;
                    case 'approved':
                        statusClass = 'status-available';
                        statusText = '✅ Approved';
                        break;
                    case 'rejected':
                        statusClass = 'status-cancelled';
                        statusText = '❌ Rejected';
                        break;
                    default:
                        statusClass = 'status-pending';
                        statusText = '⏳ Pending';
                }

                const documentCount = Object.keys(app.documents || {}).length;
                const hasRequiredDocs = documentCount >= 3;

                return `
                    <tr onclick="openApplicationReview('${app.applicationId}')" style="cursor: pointer;">
                        <td>
                            <div style="font-weight: 600; color: var(--brand-green);">${app.applicationId}</div>
                            <div style="font-size: 12px; color: var(--text-muted);">${submissionTime}</div>
                        </td>
                        <td>
                            <div style="font-weight: 600;">${app.businessName}</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">${app.businessAddress || 'Address not provided'}</div>
                            <div style="font-size: 12px; color: var(--text-muted);">License: ${app.licenseNumber}</div>
                        </td>
                        <td>
                            <div>${app.contactName}</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">${app.businessEmail}</div>
                            <div style="font-size: 12px; color: var(--text-muted);">${app.phone}</div>
                        </td>
                        <td>
                            <div style="font-weight: 600;">${app.businessType}</div>
                            <div style="font-size: 12px; color: var(--brand-green);">${app.estimatedMonthlyVolume}</div>
                            ${app.yearsInBusiness ? `<div style="font-size: 12px; color: var(--text-muted);">${app.yearsInBusiness}</div>` : ''}
                        </td>
                        <td>
                            <div>${submissionDate}</div>
                            <div style="font-size: 12px; color: var(--text-muted);">${submissionTime}</div>
                        </td>
                        <td>
                            <span class="${statusClass}">${statusText}</span>
                            ${app.reviewedBy ? `<div style="font-size: 11px; color: var(--text-muted);">by ${app.reviewedBy}</div>` : ''}
                        </td>
                        <td>
                            <div style="font-weight: 600; color: ${hasRequiredDocs ? 'var(--brand-green)' : 'var(--accent-red)'};">
                                ${documentCount} docs
                            </div>
                            <div style="font-size: 12px; color: var(--text-muted);">
                                ${hasRequiredDocs ? '✅ Complete' : '⚠️ Incomplete'}
                            </div>
                        </td>
                        <td>
                            <div style="display: flex; gap: 8px;">
                                <button class="btn btn-primary btn-sm" onclick="event.stopPropagation(); openApplicationReview('${app.applicationId}')">
                                    📋 Review
                                </button>
                                ${app.status === 'pending' ? `
                                    <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); quickApproveApplication('${app.applicationId}')">
                                        ✅
                                    </button>
                                    <button class="btn btn-danger btn-sm" onclick="event.stopPropagation(); quickRejectApplication('${app.applicationId}')">
                                        ❌
                                    </button>
                                ` : ''}
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function openApplicationReview(applicationId) {
            const application = currentApplications.find(app => app.applicationId === applicationId);
            if (!application) {
                showNotification('❌ Application not found', 'error');
                return;
            }

            currentReviewingApplication = application;

            // Generate document list
            const docsList = Object.keys(application.documents || {}).map(docType => {
                if (docType === 'additionalDocs' && Array.isArray(application.documents[docType])) {
                    return application.documents[docType].map(doc =>
                        `<div class="doc-item">📄 ${doc.name} (${(doc.size / 1024 / 1024).toFixed(2)} MB)</div>`
                    ).join('');
                } else if (application.documents[docType]) {
                    const friendlyNames = {
                        businessLicense: 'Business License',
                        cannabisLicense: 'Cannabis/Hemp License',
                        taxId: 'Tax ID/EIN Document'
                    };
                    const doc = application.documents[docType];
                    return `<div class="doc-item">📄 ${friendlyNames[docType] || docType}: ${doc.name} (${(doc.size / 1024 / 1024).toFixed(2)} MB)</div>`;
                }
                return '';
            }).join('');

            const reviewContent = document.getElementById('applicationReviewContent');
            reviewContent.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 24px;">
                    <div class="application-section">
                        <h4 style="color: var(--brand-green); margin-bottom: 16px;">🏢 Business Information</h4>
                        <div class="info-grid">
                            <div class="info-item">
                                <label>Application ID</label>
                                <span style="font-weight: 600; color: var(--brand-green);">${application.applicationId}</span>
                            </div>
                            <div class="info-item">
                                <label>Business Name</label>
                                <span>${application.businessName}</span>
                            </div>
                            <div class="info-item">
                                <label>Contact Name</label>
                                <span>${application.contactName}</span>
                            </div>
                            <div class="info-item">
                                <label>Business Type</label>
                                <span>${application.businessType}</span>
                            </div>
                            <div class="info-item">
                                <label>License Number</label>
                                <span>${application.licenseNumber}</span>
                            </div>
                            <div class="info-item">
                                <label>Estimated Monthly Volume</label>
                                <span style="color: var(--brand-green); font-weight: 600;">${application.estimatedMonthlyVolume}</span>
                            </div>
                            ${application.yearsInBusiness ? `
                                <div class="info-item">
                                    <label>Years in Business</label>
                                    <span>${application.yearsInBusiness}</span>
                                </div>
                            ` : ''}
                        </div>
                    </div>

                    <div class="application-section">
                        <h4 style="color: var(--brand-green); margin-bottom: 16px;">📞 Contact Information</h4>
                        <div class="info-grid">
                            <div class="info-item">
                                <label>Email</label>
                                <span>${application.businessEmail}</span>
                            </div>
                            <div class="info-item">
                                <label>Phone</label>
                                <span>${application.phone}</span>
                            </div>
                            <div class="info-item">
                                <label>Business Address</label>
                                <span style="white-space: pre-wrap;">${application.businessAddress}</span>
                            </div>
                            <div class="info-item">
                                <label>Submission Date</label>
                                <span>${new Date(application.submissionDate).toLocaleString()}</span>
                            </div>
                        </div>
                    </div>
                </div>

                ${application.businessDescription ? `
                    <div class="application-section" style="margin-bottom: 24px;">
                        <h4 style="color: var(--brand-green); margin-bottom: 16px;">📝 Business Description</h4>
                        <div style="background: var(--surface-elevated); padding: 16px; border-radius: 8px; white-space: pre-wrap;">
                            ${application.businessDescription}
                        </div>
                    </div>
                ` : ''}

                <div class="application-section">
                    <h4 style="color: var(--brand-green); margin-bottom: 16px;">📁 Documents Submitted</h4>
                    <div class="review-documents" style="background: var(--surface-elevated); padding: 16px; border-radius: 8px;">
                        ${docsList || '<div style="color: var(--text-muted);">No documents uploaded</div>'}
                    </div>
                </div>

                ${application.reviewNotes ? `
                    <div class="application-section" style="margin-top: 24px;">
                        <h4 style="color: var(--brand-green); margin-bottom: 16px;">📋 Review Notes</h4>
                        <div style="background: var(--surface-elevated); padding: 16px; border-radius: 8px;">
                            <div style="font-weight: 600; margin-bottom: 8px;">Reviewed by: ${application.reviewedBy}</div>
                            <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 12px;">
                                ${new Date(application.reviewedDate).toLocaleString()}
                            </div>
                            <div style="white-space: pre-wrap;">${application.reviewNotes}</div>
                        </div>
                    </div>
                ` : ''}
            `;

            openModal('applicationReviewModal');
        }

        function approveApplication() {
            if (!currentReviewingApplication) return;
            openApplicationNotesModal('approve');
        }

        function rejectApplication() {
            if (!currentReviewingApplication) return;
            openApplicationNotesModal('reject');
        }

        function openApplicationNotesModal(action) {
            document.getElementById('reviewAction').value = action;

            // Show/hide approval options
            const approvalSection = document.getElementById('approvalOptionsSection');
            if (approvalSection) {
                approvalSection.style.display = action === 'approve' ? 'block' : 'none';
            }

            closeModal('applicationReviewModal');
            openModal('applicationNotesModal');
        }

        function submitApplicationAction(event) {
            event.preventDefault();

            const action = document.getElementById('reviewAction').value;
            const notes = document.getElementById('reviewNotes').value;
            const sendEmail = document.getElementById('sendEmailNotification').checked;
            const partnerTier = document.getElementById('partnerTier').value;

            if (!currentReviewingApplication) {
                showNotification('❌ No application selected for review', 'error');
                return;
            }

            // Update application
            const appIndex = currentApplications.findIndex(app =>
                app.applicationId === currentReviewingApplication.applicationId
            );

            if (appIndex === -1) {
                showNotification('❌ Application not found', 'error');
                return;
            }

            const now = new Date().toISOString();
            currentApplications[appIndex] = {
                ...currentApplications[appIndex],
                status: action === 'request_info' ? 'pending' : action + 'd',
                reviewNotes: notes,
                reviewedBy: 'Admin User',
                reviewedDate: now,
                partnerTier: action === 'approve' ? partnerTier : null
            };

            // Save to localStorage
            localStorage.setItem('businessApplications', JSON.stringify(currentApplications));

            // If approved, add to partners list
            if (action === 'approve') {
                addApprovedPartner(currentApplications[appIndex]);
            }

            // Show success notification
            const actionText = {
                'approve': 'approved',
                'reject': 'rejected',
                'request_info': 'updated with information request'
            };

            showNotification(`✅ Application ${actionText[action]} successfully!`, 'success');

            // Close modal and refresh data
            closeModal('applicationNotesModal');
            loadApplicationsData();

            // Reset form
            document.getElementById('reviewNotes').value = '';
            currentReviewingApplication = null;
        }

        function addApprovedPartner(application) {
            try {
                const existingPartners = JSON.parse(localStorage.getItem('partners') || '[]');

                const newPartner = {
                    id: 'PARTNER-' + Date.now(),
                    businessName: application.businessName,
                    contactName: application.contactName,
                    email: application.businessEmail,
                    phone: application.phone,
                    businessType: application.businessType,
                    address: application.businessAddress,
                    licenseNumber: application.licenseNumber,
                    tier: application.partnerTier || 'starter',
                    status: 'active',
                    joinDate: new Date().toISOString(),
                    estimatedVolume: application.estimatedMonthlyVolume,
                    applicationId: application.applicationId
                };

                existingPartners.push(newPartner);
                localStorage.setItem('partners', JSON.stringify(existingPartners));

                console.log('✅ New partner added to partners list:', newPartner);
            } catch (error) {
                console.error('Error adding partner:', error);
            }
        }

        function quickApproveApplication(applicationId) {
            const app = currentApplications.find(app => app.applicationId === applicationId);
            if (!app) return;

            currentReviewingApplication = app;

            // Quick approve with default notes
            const appIndex = currentApplications.findIndex(app => app.applicationId === applicationId);
            currentApplications[appIndex] = {
                ...currentApplications[appIndex],
                status: 'approved',
                reviewNotes: 'Quick approval - application meets all requirements.',
                reviewedBy: 'Admin User',
                reviewedDate: new Date().toISOString(),
                partnerTier: 'starter'
            };

            localStorage.setItem('businessApplications', JSON.stringify(currentApplications));
            addApprovedPartner(currentApplications[appIndex]);

            showNotification('✅ Application approved successfully!', 'success');
            loadApplicationsData();
        }

        function quickRejectApplication(applicationId) {
            const appIndex = currentApplications.findIndex(app => app.applicationId === applicationId);
            if (appIndex === -1) return;

            currentApplications[appIndex] = {
                ...currentApplications[appIndex],
                status: 'rejected',
                reviewNotes: 'Application rejected - does not meet current partnership requirements.',
                reviewedBy: 'Admin User',
                reviewedDate: new Date().toISOString()
            };

            localStorage.setItem('businessApplications', JSON.stringify(currentApplications));

            showNotification('❌ Application rejected', 'warning');
            loadApplicationsData();
        }

        function refreshApplications() {
            loadApplicationsData();
            showNotification('🔄 Applications refreshed', 'success');
        }

        function filterApplicationsByStatus(status) {
            // Update filter button states
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            const rows = document.querySelectorAll('#applicationsTable tbody tr');
            rows.forEach(row => {
                if (status === 'all') {
                    row.style.display = '';
                } else if (status === 'today') {
                    // Show only today's applications
                    const rowDate = row.cells[4]?.textContent?.trim();
                    const today = new Date().toLocaleDateString();
                    row.style.display = rowDate?.includes(today) ? '' : 'none';
                } else {
                    const statusCell = row.cells[5]?.textContent?.toLowerCase();
                    row.style.display = statusCell?.includes(status) ? '' : 'none';
                }
            });
        }

        function filterApplications(searchTerm) {
            const rows = document.querySelectorAll('#applicationsTable tbody tr');
            const term = searchTerm.toLowerCase();

            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(term) ? '' : 'none';
            });
        }

        // Email Notification System
        function simulateEmailNotification(application, action, notes) {
            const emailTemplates = {
                approved: {
                    subject: `🎉 Welcome to Faded Skies Wholesale Partnership!`,
                    body: `Dear ${application.contactName},

Congratulations! Your partnership application (${application.applicationId}) has been approved.

We're excited to welcome ${application.businessName} to the Faded Skies wholesale family.

Next Steps:
1. You'll receive your login credentials within 24 hours
2. A dedicated account manager will contact you to complete onboarding
3. Access to wholesale pricing will be activated immediately

Partnership Details:
- Business: ${application.businessName}
- Partner Tier: ${application.partnerTier || 'Starter'}
- Estimated Volume: ${application.estimatedMonthlyVolume}

If you have any questions, please don't hesitate to reach out.

Welcome aboard!

Best regards,
Faded Skies Partnership Team`
                },
                rejected: {
                    subject: `Application Update - Faded Skies Wholesale`,
                    body: `Dear ${application.contactName},

Thank you for your interest in partnering with Faded Skies Wholesale.

After careful review of your application (${application.applicationId}), we're unable to move forward with a partnership at this time.

Reason: ${notes}

We appreciate your interest and encourage you to reapply in the future as your business grows.

Best regards,
Faded Skies Partnership Team`
                },
                request_info: {
                    subject: `Additional Information Needed - Application ${application.applicationId}`,
                    body: `Dear ${application.contactName},

We're reviewing your partnership application for ${application.businessName}.

To complete our review, we need some additional information:

${notes}

Please provide this information at your earliest convenience. You can reply to this email or contact us directly.

Application ID: ${application.applicationId}

Thank you for your patience.

Best regards,
Faded Skies Partnership Team`
                }
            };

            const template = emailTemplates[action];
            if (!template) return;

            // Store email in localStorage for demonstration
            const emails = JSON.parse(localStorage.getItem('sentEmails') || '[]');
            emails.unshift({
                id: 'EMAIL-' + Date.now(),
                to: application.businessEmail,
                from: 'partnerships@fadedskies.com',
                subject: template.subject,
                body: template.body,
                sentDate: new Date().toISOString(),
                applicationId: application.applicationId,
                action: action
            });
            localStorage.setItem('sentEmails', JSON.stringify(emails));

            // Show confirmation
            showNotification(`📧 Email sent to ${application.businessEmail}`, 'success');

            console.log('📧 Email notification sent:', {
                to: application.businessEmail,
                subject: template.subject,
                action: action
            });
        }

        // Update submitApplicationAction to include email notifications
        const originalSubmitApplicationAction = submitApplicationAction;
        submitApplicationAction = function(event) {
            event.preventDefault();

            const action = document.getElementById('reviewAction').value;
            const notes = document.getElementById('reviewNotes').value;
            const sendEmail = document.getElementById('sendEmailNotification').checked;

            if (!currentReviewingApplication) {
                showNotification('❌ No application selected for review', 'error');
                return;
            }

            // Call original function
            originalSubmitApplicationAction.call(this, event);

            // Send email notification if requested
            if (sendEmail && currentReviewingApplication) {
                setTimeout(() => {
                    simulateEmailNotification(currentReviewingApplication, action, notes);
                }, 500);
            }
        };

        // Application notification management
        function loadApplicationNotifications() {
            const notifications = JSON.parse(localStorage.getItem('adminNotifications') || '[]');
            const applicationNotifications = notifications.filter(n => n.type === 'new_application');

            const notificationsList = document.getElementById('notificationsList');
            if (!notificationsList) return;

            if (applicationNotifications.length === 0) {
                notificationsList.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-muted);">
                        🔔 No application notifications found
                    </div>
                `;
                return;
            }

            notificationsList.innerHTML = applicationNotifications.map(notification => `
                <div class="notification-item" style="background: var(--surface-dark); padding: 16px; border-radius: 8px; margin-bottom: 12px; border-left: 4px solid ${notification.read ? 'var(--border-subtle)' : 'var(--brand-green)'};">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;">
                        <div style="font-weight: 600; color: var(--text-primary);">${notification.title}</div>
                        <div style="font-size: 12px; color: var(--text-muted);">
                            ${new Date(notification.timestamp).toLocaleString()}
                        </div>
                    </div>
                    <div style="color: var(--text-secondary); margin-bottom: 8px;">
                        ${notification.message}
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button class="btn btn-primary btn-sm" onclick="openApplicationFromNotification('${notification.applicationId}')">
                            📋 Review Application
                        </button>
                        ${!notification.read ? `
                            <button class="btn btn-secondary btn-sm" onclick="markNotificationRead('${notification.id}')">
                                ✅ Mark Read
                            </button>
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }

        function openApplicationFromNotification(applicationId) {
            closeModal('applicationNotificationsModal');
            // Switch to applications tab if not already there
            switchTab('applications');
            // Open the specific application
            setTimeout(() => {
                openApplicationReview(applicationId);
            }, 100);
        }

        function markNotificationRead(notificationId) {
            const notifications = JSON.parse(localStorage.getItem('adminNotifications') || '[]');
            const index = notifications.findIndex(n => n.id === notificationId);
            if (index !== -1) {
                notifications[index].read = true;
                localStorage.setItem('adminNotifications', JSON.stringify(notifications));
                loadApplicationNotifications();
                showNotification('✅ Notification marked as read', 'success');
            }
        }

        function markAllNotificationsRead() {
            const notifications = JSON.parse(localStorage.getItem('adminNotifications') || '[]');
            notifications.forEach(n => {
                if (n.type === 'new_application') {
                    n.read = true;
                }
            });
            localStorage.setItem('adminNotifications', JSON.stringify(notifications));
            loadApplicationNotifications();
            showNotification('✅ All application notifications marked as read', 'success');
        }

        function clearOldNotifications() {
            const notifications = JSON.parse(localStorage.getItem('adminNotifications') || '[]');
            const oneWeekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);
            const filteredNotifications = notifications.filter(n =>
                n.type !== 'new_application' || new Date(n.timestamp) > oneWeekAgo
            );
            localStorage.setItem('adminNotifications', JSON.stringify(filteredNotifications));
            loadApplicationNotifications();
            showNotification('🗑️ Old notifications cleared', 'success');
        }

        // Global functions
        window.simulateEmailNotification = simulateEmailNotification;
        window.loadApplicationNotifications = loadApplicationNotifications;
        window.openApplicationFromNotification = openApplicationFromNotification;
        window.markNotificationRead = markNotificationRead;
        window.markAllNotificationsRead = markAllNotificationsRead;
        window.clearOldNotifications = clearOldNotifications;

        // Initialize applications when switching to applications tab
        window.loadApplicationsData = loadApplicationsData;
        window.refreshApplications = refreshApplications;
        window.filterApplicationsByStatus = filterApplicationsByStatus;
        window.filterApplications = filterApplications;
        window.openApplicationReview = openApplicationReview;
        window.approveApplication = approveApplication;
        window.rejectApplication = rejectApplication;
        window.submitApplicationAction = submitApplicationAction;
        window.quickApproveApplication = quickApproveApplication;
        window.quickRejectApplication = quickRejectApplication;
    </script>
</body>
</html>
