# Faded Skies Cannabis Wholesale Portal Schema
# Simplified schema for Data Connect compatibility

# User table for partners and admins
type User @table {
  id: String! @default(expr: "auth.uid")
  email: String! @col(dataType: "varchar(255)")
  role: String! @col(dataType: "varchar(50)")
  companyName: String @col(dataType: "varchar(255)")
  contactName: String @col(dataType: "varchar(255)")
  phone: String @col(dataType: "varchar(50)")
  address: String @col(dataType: "text")
  licenseNumber: String @col(dataType: "varchar(255)")
  status: String! @col(dataType: "varchar(50)") @default(expr: "'pending'")
  createdAt: Timestamp! @default(expr: "request.time")
  updatedAt: Timestamp! @default(expr: "request.time")
  lastLogin: Timestamp
}

# Product catalog with real-time inventory
type Product @table {
  id: UUID! @default(expr: "uuidV4()")
  name: String! @col(dataType: "varchar(255)")
  description: String @col(dataType: "text")
  category: String! @col(dataType: "varchar(100)")
  subcategory: String @col(dataType: "varchar(100)")
  thcContent: Float @col(dataType: "decimal(5,2)")
  cbdContent: Float @col(dataType: "decimal(5,2)")
  price: Float! @col(dataType: "decimal(10,2)")
  wholesalePrice: Float! @col(dataType: "decimal(10,2)")
  stockQuantity: Int! @col(dataType: "integer") @default(expr: "0")
  minOrderQuantity: Int @col(dataType: "integer")
  maxOrderQuantity: Int @col(dataType: "integer")
  status: String! @col(dataType: "varchar(50)") @default(expr: "'active'")
  images: String @col(dataType: "text")
  labResults: String @col(dataType: "text")
  createdAt: Timestamp! @default(expr: "request.time")
  updatedAt: Timestamp! @default(expr: "request.time")
  createdBy: String! @col(dataType: "varchar(255)")
}

# Orders with real-time status tracking
type Order @table {
  id: UUID! @default(expr: "uuidV4()")
  orderNumber: String! @col(dataType: "varchar(50)")
  partnerId: String! @col(dataType: "varchar(255)")
  status: String! @col(dataType: "varchar(50)") @default(expr: "'pending'")
  totalAmount: Float! @col(dataType: "decimal(10,2)")
  subtotal: Float! @col(dataType: "decimal(10,2)")
  tax: Float @col(dataType: "decimal(10,2)")
  shipping: Float @col(dataType: "decimal(10,2)")
  notes: String @col(dataType: "text")
  shippingAddress: String @col(dataType: "text")
  billingAddress: String @col(dataType: "text")
  createdAt: Timestamp! @default(expr: "request.time")
  updatedAt: Timestamp! @default(expr: "request.time")
  estimatedDelivery: Timestamp
  actualDelivery: Timestamp
  trackingNumber: String @col(dataType: "varchar(255)")
}

# Order items with product details
type OrderItem @table {
  id: UUID! @default(expr: "uuidV4()")
  orderId: UUID! @col(dataType: "uuid")
  productId: UUID! @col(dataType: "uuid")
  quantity: Int! @col(dataType: "integer")
  unitPrice: Float! @col(dataType: "decimal(10,2)")
  totalPrice: Float! @col(dataType: "decimal(10,2)")
  notes: String @col(dataType: "text")
}

# Real-time notifications system
type Notification @table {
  id: UUID! @default(expr: "uuidV4()")
  userId: String! @col(dataType: "varchar(255)")
  type: String! @col(dataType: "varchar(50)")
  title: String! @col(dataType: "varchar(255)")
  message: String! @col(dataType: "text")
  read: Boolean! @col(dataType: "boolean") @default(expr: "false")
  createdAt: Timestamp! @default(expr: "request.time")
  data: String @col(dataType: "text")
}

# System configuration for dynamic settings
type SystemConfig @table {
  id: String! @col(dataType: "varchar(100)")
  value: String! @col(dataType: "text")
  description: String @col(dataType: "text")
  updatedBy: String! @col(dataType: "varchar(255)")
  updatedAt: Timestamp! @default(expr: "request.time")
}
